<!DOCTYPE html> <html lang=" en "><head> <meta charset="utf-8"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>World equity markets valuation | Wilson Fok</title> <meta name="generator" content="Jekyll v3.9.3" /> <meta property="og:title" content="World equity markets valuation" /> <meta name="author" content="Wilson Fok" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Introduction Geopandas is a python packages for GIS (geographic information system). The package helps perform sophisticated spatial temporal analysis. Very often, we visual the findings on maps. A simple application I am going to show you here is to visualize the global equity market valuations, yield, and structure. Despite its simplicity, the maps show interesting emerging patterns across Europe, America, Asia, and Africa. Up-to-date market information can be expensive. I am not aware of any free database that provides information on individual company’s earnings, share prices, book value across the global equity markets. This is a daunting task for an amateur who has no access to paid institutional or research databases. I have found a way to partially get around the need for subscription. The idea is to study ETF factsheet or prospectus carefully to extract information on equity markets. ETF (exchange traded fund) comes in many shapes and forms. The ones I pick are passive market index funds investing in major indices of different countries. These indices constitute companies that are most liquid and tradable. While the indices themselves are not the full representation of the entire market, they cover large-cap companies that are often heavily weighted in their markets. Even though the ETF issuers are supposed to update the factsheet or prospectus whenever changes occur, the information I can get from the site can be as old as last week. Anyway, the representation from such sampling should be good enough for a part-time project. ‘ishares’ issues a number of products targeting Asia, Europe and America equities markets. To obtain the country-level graduality, I choose 41 of their ETFs, each investing fund on its respective country. The websites of all of the 41 can be found in the References section. Prerequisite Install Geopandas and all dependencies Methods Downloading data from ishares Automatic website parsing is possible on Ishares websites. I downloaded the html from the ETF’s URLs, parsed entries on the fund characteristics, and wrote the values to a csv file for later plotting. The steps were repeated for each country ETF. The structure of the data is best shown by the screenshots of the website table. This is an ETF for Finland The fund’s characteristics, which is used to infer the country’s equity market, are listed in the table below. The sectors or industries these companies belong: Data Visualization Geopandas provides a very nice world map from its “naturalearth_lowres” dataset in which each country is depicted by polygons. However, I could not find Hong Kong and Singapore on this map, so I drew an excessively large square to reflect their prominent position in the flow of capital across the world markets. Since my intention is to compare and contrast various equity markets across the globe, let mean value to be white, below mean value to be blue and above mean value to be red. Thus, the intensity of the colored world maps indicates “excesses”. Black stripes refers to regions with no information. Figures and Plots Characteristics Sectors and Industries Sectors reported on the ishare websites are not standardized. To cope with country without certain sectors or few sectors that are subcategory of boarder sectors, I regrouped and renamed specific sectors found in each country. All numbers are in %. Conclusion Ishares have not currently provided much access to Africa. I have seen other issuers offer ETFs on African counties such as Egypt, but not much else. Nonetheless, given its sheer size, population, and resources, I reckon Africa’s equity markets are the least developed and accessible compared with other corners of the world. Perhaps, one possible way to invest in the continent is to invest in multi-national companies with operations in Africa. I shall leave it here. Let the figures and code speak for themselves and let my readers draw their own conclusion. Python scripts Download Data # -*- coding: utf-8 -*- import urllib.request import re from collections import defaultdict import pandas as pd TARGETS = [&#39;&lt;div class=&quot;float-left in-left col-priceBook&#39;, &#39;&lt;div class=&quot;float-left in-right col-priceEarnings&#39;, &#39;&lt;div class=&quot;float-left in-left col-numHoldings&#39;, &#39;&lt;div class=&quot;float-left in-right col-beta3Yr&#39;, &#39;&lt;div class=&quot;float-left in-left col-thirtyDaySecYield&#39;, &#39;&lt;div class=&quot;float-left in-right col-standardDeviation3Yr&#39;, &#39;&lt;div class=&quot;float-left in-left col-twelveMonTrlYld&#39;] GROUPS= { &#39;Materials&#39;: &#39;Industrials&#39;, &#39;Communication&#39;:&#39;Telecommunications&#39;, &#39;Insurance&#39;: &#39;Financials&#39;, &#39;Diversified Financials&#39;: &#39;Financials&#39;, &#39;Capital Goods&#39;:&#39;Industrials&#39;, &#39;Banks&#39; : &#39;Financials&#39;, &#39;Consumer Services&#39;: &#39;Consumer Discretionary&#39;, &#39;Transportation&#39;: &#39;Utilities&#39;, &#39;Food Bevg Tobacco&#39;: &#39;Consumer Staples&#39;} board_categories = [&#39;Consumer Discretionary&#39;, &#39;Information Technology&#39;, &#39;Consumer Staples&#39;, &#39;Financials&#39;, &#39;Industrials&#39;, &#39;Energy&#39;, &#39;Utilities&#39;, &#39;Real Estate&#39;, &#39;Health Care&#39;, &#39;Telecommunications&#39;] def locate(target, html): for i, line in enumerate(html): if target in line: print (&#39;line {} \n target {}&#39;.format(line, target)) print () return i else: print (&#39;cannot find {}&#39;.format(target)) return None def extract(i, html): # print (html[i:i+10]) return html[i+2], html[i+5], html[i+9] def parse_javascript(x): start_ind = [] end_ind = [] ranking = defaultdict(list) for j, c in enumerate(x): if &#39;{&#39; == c: start_ind.append(j) elif &#39;}&#39; == c: end_ind.append(j) assert len(start_ind) == len(end_ind) for s,e in zip(start_ind, end_ind): # print (html[i][s:e]) items = x[s:e].split(&#39;,&#39;) value = items[0].split(&#39;:&#39;)[-1] value = re.findall(&#39;\w+&#39;, value) ranking[&#39;category&#39;].append(&#39; &#39;.join(value)) value = items[1].split(&#39;:&#39;)[-1] ranking[&#39;percentage&#39;].append(float(re.findall(&#39;\d+\.\d+&#39;, value)[0])) ranking[&#39;rank&#39;].append(int(items[2].split(&#39;:&#39;)[-1])) print (&#39;found %d categories&#39; %len(start_ind)) return ranking if __name__ == &quot;__main__&quot;: with open(&#39;weblinks.txt&#39;, &#39;r&#39;) as f: links = f.readlines() data = defaultdict(list) categories = [] for link in links: link = link.rstrip(&#39;\n&#39;) country = link.split(&#39;/&#39;) myURL = urllib.request.urlopen(link) html = myURL.read() html = html.decode(&#39;utf-8&#39;) html = html.split(&#39;\n&#39;) target = &#39;var tabsSectorDataTable =[{&quot;name&quot;:&#39; i = locate(target, html) ranking = parse_javascript(html[i]) # find all possible categories # for category in ranking[&#39;category&#39;]: # if category not in categories: # categories.append(category) for j, target in enumerate(TARGETS): i = locate(target, html) metric, date, value = extract(i, html) if j == 0: data[&#39;country&#39;].append(country) data[&#39;dates&#39;].append(date) data[metric].append(value) percentages = defaultdict(float) for c, p in zip(ranking[&#39;category&#39;], ranking[&#39;percentage&#39;]): if c in GROUPS: c = GROUPS[c] if c in board_categories: percentages[c] += p print (&#39;check sum: &#39;, sum(percentages.values())) for category in board_categories: data[category].append(percentages[category]) for key, value in data.items(): print (key, len(value)) table = pd.DataFrame.from_dict(data) table.to_csv(&#39;etf_Statistics.csv&#39;) Visualization import pandas as pd import geopandas import numpy as np # import folium import matplotlib.pyplot as plt from shapely.geometry import Polygon def str_float(x): return float(x[0:-1]) table = pd.read_csv(&#39;etf_Statistics.csv&#39;) for c in [&#39;30 Day SEC Yield&#39;, &#39;Standard Deviation (3y)&#39;, &#39;12m Trailing Yield&#39;]: table[c] = table[c].apply(str_float) # Read the geopandas dataset world = geopandas.read_file(geopandas.datasets.get_path(&#39;naturalearth_lowres&#39;)) df = pd.DataFrame( {&#39;name&#39;: [&#39;Hong Kong&#39;, &#39;Singapore&#39;], &#39;geometry&#39;: [Polygon([(111.177216, 19.302711), (117.177216, 19.302711), (117.177216, 25.302711), (111.177216, 25.302711)]), Polygon([(102.177216, 2.302711), (104.177216, 2.302711), (104.177216, 0.302711), (102.177216, 0.302711)]) ]}) world = pd.concat((world, df)) print(world.head()) names = world.name.tolist() translation = {} for c in table[&#39;country&#39;]: # print (&#39;------------------&#39;) for name in names: name2 = name.lower() name2 = name2.replace(&#39; &#39;, &#39;-&#39;) if name2 in c: translation[c] = name break else: print (c) # have to specify the country&#39;s name for some for c in table[&#39;country&#39;]: if &#39;sp-500&#39; in c: translation[c] = &#39;United States of America&#39; if &#39;uae&#39; in c: translation[c] = &#39;United Arab Emirates&#39; if &#39;287286&#39; in c: translation[c] = &#39;Argentina&#39; ind = [i for i, t in enumerate(table[&#39;country&#39;]) if t in translation] table = table.iloc[ind,:] table[&#39;country&#39;] = [translation[i] for i in table[&#39;country&#39;]] table2 = world.merge(table, how=&quot;left&quot;, left_on=[&#39;name&#39;], right_on=[&#39;country&#39;]) plt.close(&#39;all&#39;) for c in table2.columns[9:]: # plt.figure() with plt.style.context((&quot;seaborn&quot;, &quot;ggplot&quot;)): ax = table2.plot(c, figsize=(15,10), edgecolor=&quot;black&quot;, legend=True, legend_kwds={&quot;label&quot;: c, &quot;orientation&quot;:&quot;horizontal&quot;}, cmap=plt.cm.seismic, vmin=0, vmax = np.nanmean(table2[c]) * 2, missing_kwds={ &quot;color&quot;:&quot;grey&quot;, &quot;edgecolor&quot;:&quot;black&quot;, &quot;hatch&quot;:&quot;---&quot;, &quot;label&quot;:&quot;Missing Values&quot; } ) ax.set_axis_off() plt.title(c + &#39; &#39; + table2[&#39;dates&#39;][np.invert(table2[&#39;dates&#39;].isna())].iloc[0]) c = c.replace(&#39;/&#39;, &#39;_&#39;) c = c.replace(&#39; &#39;, &#39;_&#39;) plt.savefig (c + &quot;.png&quot;, transparent=True) References https://www.ishares.com/us/products/287286/ https://www.ishares.com/us/products/239689/ishares-msci-turkey-etf https://www.ishares.com/us/products/239688/ishares-msci-thailand-capped-etf https://www.ishares.com/us/products/239618/ishares-msci-chile-capped-etf https://www.ishares.com/us/products/239621/ishares-msci-denmark-capped-etf https://www.ishares.com/us/products/239647/ishares-msci-finland-capped-etf https://www.ishares.com/us/products/239661/ishares-msci-indonesia-etf https://www.ishares.com/us/products/239662/ishares-msci-ireland-capped-etf https://www.ishares.com/us/products/239663/ishares-msci-israel-capped-etf https://www.ishares.com/us/products/239673/ishares-msci-norway-capped-etf https://www.ishares.com/us/products/239672/ishares-msci-new-zealand-capped-etf https://www.ishares.com/us/products/239675/ishares-msci-philippines-etf https://www.ishares.com/us/products/239676/ishares-msci-poland-capped-etf https://www.ishares.com/us/products/239606/ishares-msci-all-peru-capped-etf https://www.ishares.com/us/products/239677/ishares-msci-russia-capped-etf https://www.ishares.com/us/products/239607/ishares-msci-australia-etf https://www.ishares.com/us/products/239615/ishares-msci-canada-etf https://www.ishares.com/us/products/239684/ishares-msci-sweden-etf https://www.ishares.com/us/products/239650/ishares-msci-germany-etf https://www.ishares.com/us/products/239657/ishares-msci-hong-kong-etf https://www.ishares.com/us/products/239665/ishares-msci-japan-etf https://www.ishares.com/us/products/239610/ishares-msci-belgium-capped-etf https://www.ishares.com/us/products/239669/ishares-msci-malaysia-etf https://www.ishares.com/us/products/239671/ishares-msci-netherlands-etf https://www.ishares.com/us/products/239609/ishares-msci-austria-capped-etf https://www.ishares.com/us/products/239683/ishares-msci-spain-capped-etf https://www.ishares.com/us/products/239648/ishares-msci-france-etf https://www.ishares.com/us/products/239678/ishares-msci-singapore-capped-etf https://www.ishares.com/us/products/239686/ishares-msci-taiwan-etf https://www.ishares.com/us/products/239690/ishares-msci-united-kingdom-etf https://www.ishares.com/us/products/239670/ishares-msci-mexico-capped-etf https://www.ishares.com/us/products/239681/ishares-msci-south-korea-capped-etf https://www.ishares.com/us/products/239612/ishares-msci-brazil-capped-etf https://www.ishares.com/us/products/239680/ishares-msci-south-africa-etf https://www.ishares.com/us/products/239536/ishares-china-largecap-etf https://www.ishares.com/us/products/254562/ishares-msci-colombia-capped-etf https://www.ishares.com/us/products/239758/ishares-india-50-etf https://www.ishares.com/us/products/271542/ishares-msci-saudi-arabia-capped-etf https://www.ishares.com/us/products/264273/ishares-msci-qatar-capped-etf https://www.ishares.com/us/products/239726/ishares-core-sp-500-etf https://www.ishares.com/us/products/264275/ishares-msci-uae-capped-etf" /> <meta property="og:description" content="Introduction Geopandas is a python packages for GIS (geographic information system). The package helps perform sophisticated spatial temporal analysis. Very often, we visual the findings on maps. A simple application I am going to show you here is to visualize the global equity market valuations, yield, and structure. Despite its simplicity, the maps show interesting emerging patterns across Europe, America, Asia, and Africa. Up-to-date market information can be expensive. I am not aware of any free database that provides information on individual company’s earnings, share prices, book value across the global equity markets. This is a daunting task for an amateur who has no access to paid institutional or research databases. I have found a way to partially get around the need for subscription. The idea is to study ETF factsheet or prospectus carefully to extract information on equity markets. ETF (exchange traded fund) comes in many shapes and forms. The ones I pick are passive market index funds investing in major indices of different countries. These indices constitute companies that are most liquid and tradable. While the indices themselves are not the full representation of the entire market, they cover large-cap companies that are often heavily weighted in their markets. Even though the ETF issuers are supposed to update the factsheet or prospectus whenever changes occur, the information I can get from the site can be as old as last week. Anyway, the representation from such sampling should be good enough for a part-time project. ‘ishares’ issues a number of products targeting Asia, Europe and America equities markets. To obtain the country-level graduality, I choose 41 of their ETFs, each investing fund on its respective country. The websites of all of the 41 can be found in the References section. Prerequisite Install Geopandas and all dependencies Methods Downloading data from ishares Automatic website parsing is possible on Ishares websites. I downloaded the html from the ETF’s URLs, parsed entries on the fund characteristics, and wrote the values to a csv file for later plotting. The steps were repeated for each country ETF. The structure of the data is best shown by the screenshots of the website table. This is an ETF for Finland The fund’s characteristics, which is used to infer the country’s equity market, are listed in the table below. The sectors or industries these companies belong: Data Visualization Geopandas provides a very nice world map from its “naturalearth_lowres” dataset in which each country is depicted by polygons. However, I could not find Hong Kong and Singapore on this map, so I drew an excessively large square to reflect their prominent position in the flow of capital across the world markets. Since my intention is to compare and contrast various equity markets across the globe, let mean value to be white, below mean value to be blue and above mean value to be red. Thus, the intensity of the colored world maps indicates “excesses”. Black stripes refers to regions with no information. Figures and Plots Characteristics Sectors and Industries Sectors reported on the ishare websites are not standardized. To cope with country without certain sectors or few sectors that are subcategory of boarder sectors, I regrouped and renamed specific sectors found in each country. All numbers are in %. Conclusion Ishares have not currently provided much access to Africa. I have seen other issuers offer ETFs on African counties such as Egypt, but not much else. Nonetheless, given its sheer size, population, and resources, I reckon Africa’s equity markets are the least developed and accessible compared with other corners of the world. Perhaps, one possible way to invest in the continent is to invest in multi-national companies with operations in Africa. I shall leave it here. Let the figures and code speak for themselves and let my readers draw their own conclusion. Python scripts Download Data # -*- coding: utf-8 -*- import urllib.request import re from collections import defaultdict import pandas as pd TARGETS = [&#39;&lt;div class=&quot;float-left in-left col-priceBook&#39;, &#39;&lt;div class=&quot;float-left in-right col-priceEarnings&#39;, &#39;&lt;div class=&quot;float-left in-left col-numHoldings&#39;, &#39;&lt;div class=&quot;float-left in-right col-beta3Yr&#39;, &#39;&lt;div class=&quot;float-left in-left col-thirtyDaySecYield&#39;, &#39;&lt;div class=&quot;float-left in-right col-standardDeviation3Yr&#39;, &#39;&lt;div class=&quot;float-left in-left col-twelveMonTrlYld&#39;] GROUPS= { &#39;Materials&#39;: &#39;Industrials&#39;, &#39;Communication&#39;:&#39;Telecommunications&#39;, &#39;Insurance&#39;: &#39;Financials&#39;, &#39;Diversified Financials&#39;: &#39;Financials&#39;, &#39;Capital Goods&#39;:&#39;Industrials&#39;, &#39;Banks&#39; : &#39;Financials&#39;, &#39;Consumer Services&#39;: &#39;Consumer Discretionary&#39;, &#39;Transportation&#39;: &#39;Utilities&#39;, &#39;Food Bevg Tobacco&#39;: &#39;Consumer Staples&#39;} board_categories = [&#39;Consumer Discretionary&#39;, &#39;Information Technology&#39;, &#39;Consumer Staples&#39;, &#39;Financials&#39;, &#39;Industrials&#39;, &#39;Energy&#39;, &#39;Utilities&#39;, &#39;Real Estate&#39;, &#39;Health Care&#39;, &#39;Telecommunications&#39;] def locate(target, html): for i, line in enumerate(html): if target in line: print (&#39;line {} \n target {}&#39;.format(line, target)) print () return i else: print (&#39;cannot find {}&#39;.format(target)) return None def extract(i, html): # print (html[i:i+10]) return html[i+2], html[i+5], html[i+9] def parse_javascript(x): start_ind = [] end_ind = [] ranking = defaultdict(list) for j, c in enumerate(x): if &#39;{&#39; == c: start_ind.append(j) elif &#39;}&#39; == c: end_ind.append(j) assert len(start_ind) == len(end_ind) for s,e in zip(start_ind, end_ind): # print (html[i][s:e]) items = x[s:e].split(&#39;,&#39;) value = items[0].split(&#39;:&#39;)[-1] value = re.findall(&#39;\w+&#39;, value) ranking[&#39;category&#39;].append(&#39; &#39;.join(value)) value = items[1].split(&#39;:&#39;)[-1] ranking[&#39;percentage&#39;].append(float(re.findall(&#39;\d+\.\d+&#39;, value)[0])) ranking[&#39;rank&#39;].append(int(items[2].split(&#39;:&#39;)[-1])) print (&#39;found %d categories&#39; %len(start_ind)) return ranking if __name__ == &quot;__main__&quot;: with open(&#39;weblinks.txt&#39;, &#39;r&#39;) as f: links = f.readlines() data = defaultdict(list) categories = [] for link in links: link = link.rstrip(&#39;\n&#39;) country = link.split(&#39;/&#39;) myURL = urllib.request.urlopen(link) html = myURL.read() html = html.decode(&#39;utf-8&#39;) html = html.split(&#39;\n&#39;) target = &#39;var tabsSectorDataTable =[{&quot;name&quot;:&#39; i = locate(target, html) ranking = parse_javascript(html[i]) # find all possible categories # for category in ranking[&#39;category&#39;]: # if category not in categories: # categories.append(category) for j, target in enumerate(TARGETS): i = locate(target, html) metric, date, value = extract(i, html) if j == 0: data[&#39;country&#39;].append(country) data[&#39;dates&#39;].append(date) data[metric].append(value) percentages = defaultdict(float) for c, p in zip(ranking[&#39;category&#39;], ranking[&#39;percentage&#39;]): if c in GROUPS: c = GROUPS[c] if c in board_categories: percentages[c] += p print (&#39;check sum: &#39;, sum(percentages.values())) for category in board_categories: data[category].append(percentages[category]) for key, value in data.items(): print (key, len(value)) table = pd.DataFrame.from_dict(data) table.to_csv(&#39;etf_Statistics.csv&#39;) Visualization import pandas as pd import geopandas import numpy as np # import folium import matplotlib.pyplot as plt from shapely.geometry import Polygon def str_float(x): return float(x[0:-1]) table = pd.read_csv(&#39;etf_Statistics.csv&#39;) for c in [&#39;30 Day SEC Yield&#39;, &#39;Standard Deviation (3y)&#39;, &#39;12m Trailing Yield&#39;]: table[c] = table[c].apply(str_float) # Read the geopandas dataset world = geopandas.read_file(geopandas.datasets.get_path(&#39;naturalearth_lowres&#39;)) df = pd.DataFrame( {&#39;name&#39;: [&#39;Hong Kong&#39;, &#39;Singapore&#39;], &#39;geometry&#39;: [Polygon([(111.177216, 19.302711), (117.177216, 19.302711), (117.177216, 25.302711), (111.177216, 25.302711)]), Polygon([(102.177216, 2.302711), (104.177216, 2.302711), (104.177216, 0.302711), (102.177216, 0.302711)]) ]}) world = pd.concat((world, df)) print(world.head()) names = world.name.tolist() translation = {} for c in table[&#39;country&#39;]: # print (&#39;------------------&#39;) for name in names: name2 = name.lower() name2 = name2.replace(&#39; &#39;, &#39;-&#39;) if name2 in c: translation[c] = name break else: print (c) # have to specify the country&#39;s name for some for c in table[&#39;country&#39;]: if &#39;sp-500&#39; in c: translation[c] = &#39;United States of America&#39; if &#39;uae&#39; in c: translation[c] = &#39;United Arab Emirates&#39; if &#39;287286&#39; in c: translation[c] = &#39;Argentina&#39; ind = [i for i, t in enumerate(table[&#39;country&#39;]) if t in translation] table = table.iloc[ind,:] table[&#39;country&#39;] = [translation[i] for i in table[&#39;country&#39;]] table2 = world.merge(table, how=&quot;left&quot;, left_on=[&#39;name&#39;], right_on=[&#39;country&#39;]) plt.close(&#39;all&#39;) for c in table2.columns[9:]: # plt.figure() with plt.style.context((&quot;seaborn&quot;, &quot;ggplot&quot;)): ax = table2.plot(c, figsize=(15,10), edgecolor=&quot;black&quot;, legend=True, legend_kwds={&quot;label&quot;: c, &quot;orientation&quot;:&quot;horizontal&quot;}, cmap=plt.cm.seismic, vmin=0, vmax = np.nanmean(table2[c]) * 2, missing_kwds={ &quot;color&quot;:&quot;grey&quot;, &quot;edgecolor&quot;:&quot;black&quot;, &quot;hatch&quot;:&quot;---&quot;, &quot;label&quot;:&quot;Missing Values&quot; } ) ax.set_axis_off() plt.title(c + &#39; &#39; + table2[&#39;dates&#39;][np.invert(table2[&#39;dates&#39;].isna())].iloc[0]) c = c.replace(&#39;/&#39;, &#39;_&#39;) c = c.replace(&#39; &#39;, &#39;_&#39;) plt.savefig (c + &quot;.png&quot;, transparent=True) References https://www.ishares.com/us/products/287286/ https://www.ishares.com/us/products/239689/ishares-msci-turkey-etf https://www.ishares.com/us/products/239688/ishares-msci-thailand-capped-etf https://www.ishares.com/us/products/239618/ishares-msci-chile-capped-etf https://www.ishares.com/us/products/239621/ishares-msci-denmark-capped-etf https://www.ishares.com/us/products/239647/ishares-msci-finland-capped-etf https://www.ishares.com/us/products/239661/ishares-msci-indonesia-etf https://www.ishares.com/us/products/239662/ishares-msci-ireland-capped-etf https://www.ishares.com/us/products/239663/ishares-msci-israel-capped-etf https://www.ishares.com/us/products/239673/ishares-msci-norway-capped-etf https://www.ishares.com/us/products/239672/ishares-msci-new-zealand-capped-etf https://www.ishares.com/us/products/239675/ishares-msci-philippines-etf https://www.ishares.com/us/products/239676/ishares-msci-poland-capped-etf https://www.ishares.com/us/products/239606/ishares-msci-all-peru-capped-etf https://www.ishares.com/us/products/239677/ishares-msci-russia-capped-etf https://www.ishares.com/us/products/239607/ishares-msci-australia-etf https://www.ishares.com/us/products/239615/ishares-msci-canada-etf https://www.ishares.com/us/products/239684/ishares-msci-sweden-etf https://www.ishares.com/us/products/239650/ishares-msci-germany-etf https://www.ishares.com/us/products/239657/ishares-msci-hong-kong-etf https://www.ishares.com/us/products/239665/ishares-msci-japan-etf https://www.ishares.com/us/products/239610/ishares-msci-belgium-capped-etf https://www.ishares.com/us/products/239669/ishares-msci-malaysia-etf https://www.ishares.com/us/products/239671/ishares-msci-netherlands-etf https://www.ishares.com/us/products/239609/ishares-msci-austria-capped-etf https://www.ishares.com/us/products/239683/ishares-msci-spain-capped-etf https://www.ishares.com/us/products/239648/ishares-msci-france-etf https://www.ishares.com/us/products/239678/ishares-msci-singapore-capped-etf https://www.ishares.com/us/products/239686/ishares-msci-taiwan-etf https://www.ishares.com/us/products/239690/ishares-msci-united-kingdom-etf https://www.ishares.com/us/products/239670/ishares-msci-mexico-capped-etf https://www.ishares.com/us/products/239681/ishares-msci-south-korea-capped-etf https://www.ishares.com/us/products/239612/ishares-msci-brazil-capped-etf https://www.ishares.com/us/products/239680/ishares-msci-south-africa-etf https://www.ishares.com/us/products/239536/ishares-china-largecap-etf https://www.ishares.com/us/products/254562/ishares-msci-colombia-capped-etf https://www.ishares.com/us/products/239758/ishares-india-50-etf https://www.ishares.com/us/products/271542/ishares-msci-saudi-arabia-capped-etf https://www.ishares.com/us/products/264273/ishares-msci-qatar-capped-etf https://www.ishares.com/us/products/239726/ishares-core-sp-500-etf https://www.ishares.com/us/products/264275/ishares-msci-uae-capped-etf" /> <link rel="canonical" href="/finance/2021/10/05/world_equities_market_valuation/" /> <meta property="og:url" content="/finance/2021/10/05/world_equities_market_valuation/" /> <meta property="og:site_name" content="Wilson Fok" /> <meta property="og:image" content="/assets/images/world/characteristics.JPG" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2021-10-05T00:00:00+08:00" /> <meta name="twitter:card" content="summary_large_image" /> <meta property="twitter:image" content="/assets/images/world/characteristics.JPG" /> <meta property="twitter:title" content="World equity markets valuation" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Wilson Fok"},"dateModified":"2021-10-05T00:00:00+08:00","datePublished":"2021-10-05T00:00:00+08:00","description":"Introduction Geopandas is a python packages for GIS (geographic information system). The package helps perform sophisticated spatial temporal analysis. Very often, we visual the findings on maps. A simple application I am going to show you here is to visualize the global equity market valuations, yield, and structure. Despite its simplicity, the maps show interesting emerging patterns across Europe, America, Asia, and Africa. Up-to-date market information can be expensive. I am not aware of any free database that provides information on individual company’s earnings, share prices, book value across the global equity markets. This is a daunting task for an amateur who has no access to paid institutional or research databases. I have found a way to partially get around the need for subscription. The idea is to study ETF factsheet or prospectus carefully to extract information on equity markets. ETF (exchange traded fund) comes in many shapes and forms. The ones I pick are passive market index funds investing in major indices of different countries. These indices constitute companies that are most liquid and tradable. While the indices themselves are not the full representation of the entire market, they cover large-cap companies that are often heavily weighted in their markets. Even though the ETF issuers are supposed to update the factsheet or prospectus whenever changes occur, the information I can get from the site can be as old as last week. Anyway, the representation from such sampling should be good enough for a part-time project. ‘ishares’ issues a number of products targeting Asia, Europe and America equities markets. To obtain the country-level graduality, I choose 41 of their ETFs, each investing fund on its respective country. The websites of all of the 41 can be found in the References section. Prerequisite Install Geopandas and all dependencies Methods Downloading data from ishares Automatic website parsing is possible on Ishares websites. I downloaded the html from the ETF’s URLs, parsed entries on the fund characteristics, and wrote the values to a csv file for later plotting. The steps were repeated for each country ETF. The structure of the data is best shown by the screenshots of the website table. This is an ETF for Finland The fund’s characteristics, which is used to infer the country’s equity market, are listed in the table below. The sectors or industries these companies belong: Data Visualization Geopandas provides a very nice world map from its “naturalearth_lowres” dataset in which each country is depicted by polygons. However, I could not find Hong Kong and Singapore on this map, so I drew an excessively large square to reflect their prominent position in the flow of capital across the world markets. Since my intention is to compare and contrast various equity markets across the globe, let mean value to be white, below mean value to be blue and above mean value to be red. Thus, the intensity of the colored world maps indicates “excesses”. Black stripes refers to regions with no information. Figures and Plots Characteristics Sectors and Industries Sectors reported on the ishare websites are not standardized. To cope with country without certain sectors or few sectors that are subcategory of boarder sectors, I regrouped and renamed specific sectors found in each country. All numbers are in %. Conclusion Ishares have not currently provided much access to Africa. I have seen other issuers offer ETFs on African counties such as Egypt, but not much else. Nonetheless, given its sheer size, population, and resources, I reckon Africa’s equity markets are the least developed and accessible compared with other corners of the world. Perhaps, one possible way to invest in the continent is to invest in multi-national companies with operations in Africa. I shall leave it here. Let the figures and code speak for themselves and let my readers draw their own conclusion. Python scripts Download Data # -*- coding: utf-8 -*- import urllib.request import re from collections import defaultdict import pandas as pd TARGETS = [&#39;&lt;div class=&quot;float-left in-left col-priceBook&#39;, &#39;&lt;div class=&quot;float-left in-right col-priceEarnings&#39;, &#39;&lt;div class=&quot;float-left in-left col-numHoldings&#39;, &#39;&lt;div class=&quot;float-left in-right col-beta3Yr&#39;, &#39;&lt;div class=&quot;float-left in-left col-thirtyDaySecYield&#39;, &#39;&lt;div class=&quot;float-left in-right col-standardDeviation3Yr&#39;, &#39;&lt;div class=&quot;float-left in-left col-twelveMonTrlYld&#39;] GROUPS= { &#39;Materials&#39;: &#39;Industrials&#39;, &#39;Communication&#39;:&#39;Telecommunications&#39;, &#39;Insurance&#39;: &#39;Financials&#39;, &#39;Diversified Financials&#39;: &#39;Financials&#39;, &#39;Capital Goods&#39;:&#39;Industrials&#39;, &#39;Banks&#39; : &#39;Financials&#39;, &#39;Consumer Services&#39;: &#39;Consumer Discretionary&#39;, &#39;Transportation&#39;: &#39;Utilities&#39;, &#39;Food Bevg Tobacco&#39;: &#39;Consumer Staples&#39;} board_categories = [&#39;Consumer Discretionary&#39;, &#39;Information Technology&#39;, &#39;Consumer Staples&#39;, &#39;Financials&#39;, &#39;Industrials&#39;, &#39;Energy&#39;, &#39;Utilities&#39;, &#39;Real Estate&#39;, &#39;Health Care&#39;, &#39;Telecommunications&#39;] def locate(target, html): for i, line in enumerate(html): if target in line: print (&#39;line {} \\n target {}&#39;.format(line, target)) print () return i else: print (&#39;cannot find {}&#39;.format(target)) return None def extract(i, html): # print (html[i:i+10]) return html[i+2], html[i+5], html[i+9] def parse_javascript(x): start_ind = [] end_ind = [] ranking = defaultdict(list) for j, c in enumerate(x): if &#39;{&#39; == c: start_ind.append(j) elif &#39;}&#39; == c: end_ind.append(j) assert len(start_ind) == len(end_ind) for s,e in zip(start_ind, end_ind): # print (html[i][s:e]) items = x[s:e].split(&#39;,&#39;) value = items[0].split(&#39;:&#39;)[-1] value = re.findall(&#39;\\w+&#39;, value) ranking[&#39;category&#39;].append(&#39; &#39;.join(value)) value = items[1].split(&#39;:&#39;)[-1] ranking[&#39;percentage&#39;].append(float(re.findall(&#39;\\d+\\.\\d+&#39;, value)[0])) ranking[&#39;rank&#39;].append(int(items[2].split(&#39;:&#39;)[-1])) print (&#39;found %d categories&#39; %len(start_ind)) return ranking if __name__ == &quot;__main__&quot;: with open(&#39;weblinks.txt&#39;, &#39;r&#39;) as f: links = f.readlines() data = defaultdict(list) categories = [] for link in links: link = link.rstrip(&#39;\\n&#39;) country = link.split(&#39;/&#39;) myURL = urllib.request.urlopen(link) html = myURL.read() html = html.decode(&#39;utf-8&#39;) html = html.split(&#39;\\n&#39;) target = &#39;var tabsSectorDataTable =[{&quot;name&quot;:&#39; i = locate(target, html) ranking = parse_javascript(html[i]) # find all possible categories # for category in ranking[&#39;category&#39;]: # if category not in categories: # categories.append(category) for j, target in enumerate(TARGETS): i = locate(target, html) metric, date, value = extract(i, html) if j == 0: data[&#39;country&#39;].append(country) data[&#39;dates&#39;].append(date) data[metric].append(value) percentages = defaultdict(float) for c, p in zip(ranking[&#39;category&#39;], ranking[&#39;percentage&#39;]): if c in GROUPS: c = GROUPS[c] if c in board_categories: percentages[c] += p print (&#39;check sum: &#39;, sum(percentages.values())) for category in board_categories: data[category].append(percentages[category]) for key, value in data.items(): print (key, len(value)) table = pd.DataFrame.from_dict(data) table.to_csv(&#39;etf_Statistics.csv&#39;) Visualization import pandas as pd import geopandas import numpy as np # import folium import matplotlib.pyplot as plt from shapely.geometry import Polygon def str_float(x): return float(x[0:-1]) table = pd.read_csv(&#39;etf_Statistics.csv&#39;) for c in [&#39;30 Day SEC Yield&#39;, &#39;Standard Deviation (3y)&#39;, &#39;12m Trailing Yield&#39;]: table[c] = table[c].apply(str_float) # Read the geopandas dataset world = geopandas.read_file(geopandas.datasets.get_path(&#39;naturalearth_lowres&#39;)) df = pd.DataFrame( {&#39;name&#39;: [&#39;Hong Kong&#39;, &#39;Singapore&#39;], &#39;geometry&#39;: [Polygon([(111.177216, 19.302711), (117.177216, 19.302711), (117.177216, 25.302711), (111.177216, 25.302711)]), Polygon([(102.177216, 2.302711), (104.177216, 2.302711), (104.177216, 0.302711), (102.177216, 0.302711)]) ]}) world = pd.concat((world, df)) print(world.head()) names = world.name.tolist() translation = {} for c in table[&#39;country&#39;]: # print (&#39;------------------&#39;) for name in names: name2 = name.lower() name2 = name2.replace(&#39; &#39;, &#39;-&#39;) if name2 in c: translation[c] = name break else: print (c) # have to specify the country&#39;s name for some for c in table[&#39;country&#39;]: if &#39;sp-500&#39; in c: translation[c] = &#39;United States of America&#39; if &#39;uae&#39; in c: translation[c] = &#39;United Arab Emirates&#39; if &#39;287286&#39; in c: translation[c] = &#39;Argentina&#39; ind = [i for i, t in enumerate(table[&#39;country&#39;]) if t in translation] table = table.iloc[ind,:] table[&#39;country&#39;] = [translation[i] for i in table[&#39;country&#39;]] table2 = world.merge(table, how=&quot;left&quot;, left_on=[&#39;name&#39;], right_on=[&#39;country&#39;]) plt.close(&#39;all&#39;) for c in table2.columns[9:]: # plt.figure() with plt.style.context((&quot;seaborn&quot;, &quot;ggplot&quot;)): ax = table2.plot(c, figsize=(15,10), edgecolor=&quot;black&quot;, legend=True, legend_kwds={&quot;label&quot;: c, &quot;orientation&quot;:&quot;horizontal&quot;}, cmap=plt.cm.seismic, vmin=0, vmax = np.nanmean(table2[c]) * 2, missing_kwds={ &quot;color&quot;:&quot;grey&quot;, &quot;edgecolor&quot;:&quot;black&quot;, &quot;hatch&quot;:&quot;---&quot;, &quot;label&quot;:&quot;Missing Values&quot; } ) ax.set_axis_off() plt.title(c + &#39; &#39; + table2[&#39;dates&#39;][np.invert(table2[&#39;dates&#39;].isna())].iloc[0]) c = c.replace(&#39;/&#39;, &#39;_&#39;) c = c.replace(&#39; &#39;, &#39;_&#39;) plt.savefig (c + &quot;.png&quot;, transparent=True) References https://www.ishares.com/us/products/287286/ https://www.ishares.com/us/products/239689/ishares-msci-turkey-etf https://www.ishares.com/us/products/239688/ishares-msci-thailand-capped-etf https://www.ishares.com/us/products/239618/ishares-msci-chile-capped-etf https://www.ishares.com/us/products/239621/ishares-msci-denmark-capped-etf https://www.ishares.com/us/products/239647/ishares-msci-finland-capped-etf https://www.ishares.com/us/products/239661/ishares-msci-indonesia-etf https://www.ishares.com/us/products/239662/ishares-msci-ireland-capped-etf https://www.ishares.com/us/products/239663/ishares-msci-israel-capped-etf https://www.ishares.com/us/products/239673/ishares-msci-norway-capped-etf https://www.ishares.com/us/products/239672/ishares-msci-new-zealand-capped-etf https://www.ishares.com/us/products/239675/ishares-msci-philippines-etf https://www.ishares.com/us/products/239676/ishares-msci-poland-capped-etf https://www.ishares.com/us/products/239606/ishares-msci-all-peru-capped-etf https://www.ishares.com/us/products/239677/ishares-msci-russia-capped-etf https://www.ishares.com/us/products/239607/ishares-msci-australia-etf https://www.ishares.com/us/products/239615/ishares-msci-canada-etf https://www.ishares.com/us/products/239684/ishares-msci-sweden-etf https://www.ishares.com/us/products/239650/ishares-msci-germany-etf https://www.ishares.com/us/products/239657/ishares-msci-hong-kong-etf https://www.ishares.com/us/products/239665/ishares-msci-japan-etf https://www.ishares.com/us/products/239610/ishares-msci-belgium-capped-etf https://www.ishares.com/us/products/239669/ishares-msci-malaysia-etf https://www.ishares.com/us/products/239671/ishares-msci-netherlands-etf https://www.ishares.com/us/products/239609/ishares-msci-austria-capped-etf https://www.ishares.com/us/products/239683/ishares-msci-spain-capped-etf https://www.ishares.com/us/products/239648/ishares-msci-france-etf https://www.ishares.com/us/products/239678/ishares-msci-singapore-capped-etf https://www.ishares.com/us/products/239686/ishares-msci-taiwan-etf https://www.ishares.com/us/products/239690/ishares-msci-united-kingdom-etf https://www.ishares.com/us/products/239670/ishares-msci-mexico-capped-etf https://www.ishares.com/us/products/239681/ishares-msci-south-korea-capped-etf https://www.ishares.com/us/products/239612/ishares-msci-brazil-capped-etf https://www.ishares.com/us/products/239680/ishares-msci-south-africa-etf https://www.ishares.com/us/products/239536/ishares-china-largecap-etf https://www.ishares.com/us/products/254562/ishares-msci-colombia-capped-etf https://www.ishares.com/us/products/239758/ishares-india-50-etf https://www.ishares.com/us/products/271542/ishares-msci-saudi-arabia-capped-etf https://www.ishares.com/us/products/264273/ishares-msci-qatar-capped-etf https://www.ishares.com/us/products/239726/ishares-core-sp-500-etf https://www.ishares.com/us/products/264275/ishares-msci-uae-capped-etf","headline":"World equity markets valuation","image":"/assets/images/world/characteristics.JPG","mainEntityOfPage":{"@type":"WebPage","@id":"/finance/2021/10/05/world_equities_market_valuation/"},"url":"/finance/2021/10/05/world_equities_market_valuation/"}</script> <!-- End Jekyll SEO tag --> <title>Wilson Fok - A data science enthusiast</title> <meta http-equip="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <meta name="description" content="World equity markets valuation" /> <meta name="keywords" content="World equity markets valuation, Wilson Fok, Finance" /> <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml"> <meta content="" property="fb:app_id"> <meta content="Wilson Fok" property="og:site_name"> <meta content="World equity markets valuation" property="og:title"> <meta content="article" property="og:type"> <meta content="Let's use Geopandas to plot world equity markets" property="og:description"> <meta content="/finance/2021/10/05/world_equities_market_valuation/" property="og:url"> <meta content="2021-10-05T00:00:00+08:00" property="article:published_time"> <meta content="/about/" property="article:author"> <meta content="/assets/img/posts//assets/images/world/characteristics.JPG" property="og:image"> <meta content="Finance" property="article:section"> <meta name="twitter:card" content="summary"> <meta name="twitter:site" content="@"> <meta name="twitter:creator" content="@"> <meta name="twitter:title" content="World equity markets valuation"> <meta content="Wilson Fok" property="og:site_name"> <meta name="twitter:url" content="/finance/2021/10/05/world_equities_market_valuation/"> <meta name="twitter:description" content="Hello, My name is Wilson Fok. I love to extract useful insights and knowledge from big data. I also like to make new friends and connections. Let's connect! "> <!-- load layout style css --> <link rel="stylesheet" href="/assets/css/main.css" /> <link rel="stylesheet" href="/assets/css/custom-style.css" /> <link rel="stylesheet" href="/assets/bower_components/lightgallery/dist/css/lightgallery.min.css"/> <link rel="stylesheet" href="/assets/bower_components/bootstrap/dist/css/bootstrap.min.css" /> <link rel="stylesheet" href="/assets/bower_components/font-awesome/web-fonts-with-css/css/fontawesome-all.min.css" /> <!-- Favicon --> <link rel="icon" href="/assets/img/favicon.ico" type="image/gif" sizes="16x16"> <!-- Jquery --> <!-- one or more of the below scripts does fancy word animation and dropdown menu --> <script src="/assets/extra_js/jquery-3.4.1.min.js"></script> <script src="/assets/extra_js/picturefill min/picturefill.min.js"></script> <script src="/assets/extra_js/instantsearch min/instantsearch.min.js"></script> <script src="/assets/extra_js/moment min/moment.min.js"></script> <script src="/assets/bower_components/jquery.easing/jquery.easing.min.js"></script> <script src="/assets/bower_components/bootstrap/dist/js/bootstrap.bundle.min.js"></script> <script src="/assets/bower_components/jquery-mousewheel/jquery.mousewheel.min.js"></script> <script src="/assets/bower_components/lightgallery/dist/js/lightgallery-all.min.js"></script> <script src="/assets/bower_components/imagesloaded/imagesloaded.pkgd.min.js"></script> <script src="/assets/bower_components/nanobar/nanobar.min.js"></script> <script src="/assets/bower_components/typewrite/dist/typewrite.min.js"></script> <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> </head><body> <div class="container-fluid"><header> <script src="https://cdn.knightlab.com/libs/juxtapose/latest/js/juxtapose.min.js"></script> <link rel="stylesheet" href="https://cdn.knightlab.com/libs/juxtapose/latest/css/juxtapose.css"> <div class="col-lg-12"> <div class="row"> <nav class="navbar navbar-expand-lg fixed-top navbar-dark " id="topNav"> <!-- <a class="navbar-brand" href="#">Wilson Fok</a> --> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="/">Wilson Fok</a> <div class="collapse navbar-collapse" id="navbarNav"> <ul class="navbar-nav"> <li class="nav-item"> <a class="nav-link" href="/about">About Me</a> </li> <li class="nav-item"> <a class="nav-link" href="/blog">Blog</a> </li> <li class="nav-item"> <a class="nav-link" href="/blog/categories">Categories</a> </li> <li class="nav-item"> <a class="nav-link" href="/gallery">Gallery</a> </li> <li class="nav-item"> <a class="nav-link" href="/contact">Contact Me</a> </li> </ul> </div> <ul class="nav justify-content-end"> <!-- <li class="nav-item"> <a class="nav-link" id="search-icon" href="/search/"><i class="fa fa-search" aria-hidden="true"></i></a> </li> --> <li class="nav-item"> <input class="nav-link switch" id="theme-toggle" onclick="modeSwitcher() "type="checkbox" name="checkbox" > </li> </ul> </nav> </div> </div> </header><div class="col-lg-12"> <!-- Blog Post Breadcrumbs --><div class="col-lg-12"> <nav aria-label="breadcrumb" role="navigation"> <ol class="breadcrumb"> <li class="breadcrumb-item"> <a href="/blog"><i class="fa fa-home" aria-hidden="true"></i></a> </li> <li class="breadcrumb-item active" aria-current="page"><a href="/finance/2021/10/05/world_equities_market_valuation/">World equity markets valuation</a></li> </ol> </nav> </div><div class="row" id="blog-post-container"> <div class="col-lg-8 offset-md-2"><article class="card" itemscope itemtype="http://schema.org/BlogPosting"> <div class="card-header"> <h1 class="post-title" itemprop="name headline">World equity markets valuation</h1> <p></p> <h6 class="post-meta"> <i> Summary : Let's use Geopandas to plot world equity markets</i> </h6> <p class="post-summary">Posted by : <img src="/assets/img/profile.png" class="author-profile-img"> <span itemprop="author" itemscope itemtype="http://schema.org/Person"> <span itemprop="name">Wilson Fok</span> </span> on <time datetime="2021-10-05 00:00:00 +0800" itemprop="datePublished">Oct 5, 2021</time> </p> <span class="disqus-comment-count" data-disqus-identifier="/finance/2021/10/05/world_equities_market_valuation/"></span> <div class="post-categories"> Category : <a href="/blog/categories/Finance">Finance</a> </div> </div> <div class="card-body" itemprop="articleBody"> <h2 id="introduction">Introduction</h2> <p>Geopandas is a python packages for GIS (geographic information system). The package helps perform sophisticated spatial temporal analysis. Very often, we visual the findings on maps. A simple application I am going to show you here is to visualize the global equity market valuations, yield, and structure. Despite its simplicity, the maps show interesting emerging patterns across Europe, America, Asia, and Africa.</p> <p>Up-to-date market information can be expensive. I am not aware of any free database that provides information on individual company’s earnings, share prices, book value across the global equity markets. This is a daunting task for an amateur who has no access to paid institutional or research databases. I have found a way to partially get around the need for subscription. The idea is to study ETF factsheet or prospectus carefully to extract information on equity markets. ETF (exchange traded fund) comes in many shapes and forms. The ones I pick are passive market index funds investing in major indices of different countries. These indices constitute companies that are most liquid and tradable. While the indices themselves are not the full representation of the entire market, they cover large-cap companies that are often heavily weighted in their markets. Even though the ETF issuers are supposed to update the factsheet or prospectus whenever changes occur, the information I can get from the site can be as old as last week. Anyway, the representation from such sampling should be good enough for a part-time project.</p> <p>‘ishares’ issues a number of products targeting Asia, Europe and America equities markets. To obtain the country-level graduality, I choose 41 of their ETFs, each investing fund on its respective country. The websites of all of the 41 can be found in the References section.</p> <h2 id="prerequisite">Prerequisite</h2> <p>Install Geopandas and all dependencies</p> <h2 id="methods">Methods</h2> <h4 id="downloading-data-from-ishares">Downloading data from ishares</h4> <p>Automatic website parsing is possible on Ishares websites. I downloaded the html from the ETF’s URLs, parsed entries on the fund characteristics, and wrote the values to a csv file for later plotting. The steps were repeated for each country ETF. The structure of the data is best shown by the screenshots of the website table.</p> <p>This is an ETF for Finland <img src="/assets/images/world/title.JPG" alt="Picture description" width="1024px" /></p> <p>The fund’s characteristics, which is used to infer the country’s equity market, are listed in the table below. <img src="/assets/images/world/characteristics.JPG" alt="Picture description" width="1024px" /></p> <p>The sectors or industries these companies belong: <img src="/assets/images/world/sectors.JPG" alt="Picture description" width="1024px" /></p> <h4 id="data-visualization">Data Visualization</h4> <p>Geopandas provides a very nice world map from its “naturalearth_lowres” dataset in which each country is depicted by polygons. However, I could not find Hong Kong and Singapore on this map, so I drew an excessively large square to reflect their prominent position in the flow of capital across the world markets.</p> <p>Since my intention is to compare and contrast various equity markets across the globe, let mean value to be white, below mean value to be blue and above mean value to be red. Thus, the intensity of the colored world maps indicates “excesses”. Black stripes refers to regions with no information.</p> <h2 id="figures-and-plots">Figures and Plots</h2> <h4 id="characteristics">Characteristics</h4> <p><img src="/assets/images/world/P_B_Ratio.png" alt="Picture description" width="1024px" /> <img src="/assets/images/world/P_E_Ratio.png" alt="Picture description" width="1024px" /> <img src="/assets/images/world/Number_of_Holdings.png" alt="Picture description" width="1024px" /> <img src="/assets/images/world/Equity_Beta_(3y).png" alt="Picture description" width="1024px" /> <img src="/assets/images/world/30_Day_SEC_Yield.png" alt="Picture description" width="1024px" /> <img src="/assets/images/world/Standard_Deviation_(3y).png" alt="Picture description" width="1024px" /> <img src="/assets/images/world/12m_Trailing_Yield.png" alt="Picture description" width="1024px" /></p> <h4 id="sectors-and-industries">Sectors and Industries</h4> <p>Sectors reported on the ishare websites are not standardized. To cope with country without certain sectors or few sectors that are subcategory of boarder sectors, I regrouped and renamed specific sectors found in each country. All numbers are in %.</p> <p><img src="/assets/images/world/Consumer_Discretionary.png" alt="Picture description" width="1024px" /> <img src="/assets/images/world/Information_Technology.png" alt="Picture description" width="1024px" /> <img src="/assets/images/world/Consumer_Staples.png" alt="Picture description" width="1024px" /> <img src="/assets/images/world/Financials.png" alt="Picture description" width="1024px" /> <img src="/assets/images/world/Industrials.png" alt="Picture description" width="1024px" /> <img src="/assets/images/world/Energy.png" alt="Picture description" width="1024px" /> <img src="/assets/images/world/Utilities.png" alt="Picture description" width="1024px" /> <img src="/assets/images/world/Real_Estate.png" alt="Picture description" width="1024px" /> <img src="/assets/images/world/Health_Care.png" alt="Picture description" width="1024px" /> <img src="/assets/images/world/Telecommunications.png" alt="Picture description" width="1024px" /></p> <h2 id="conclusion">Conclusion</h2> <p>Ishares have not currently provided much access to Africa. I have seen other issuers offer ETFs on African counties such as Egypt, but not much else. Nonetheless, given its sheer size, population, and resources, I reckon Africa’s equity markets are the least developed and accessible compared with other corners of the world. Perhaps, one possible way to invest in the continent is to invest in multi-national companies with operations in Africa. I shall leave it here. Let the figures and code speak for themselves and let my readers draw their own conclusion.</p> <h2 id="python-scripts">Python scripts</h2> <h3 id="download-data">Download Data</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1"># -*- coding: utf-8 -*-
</span>
<span class="kn">import</span> <span class="nn">urllib.request</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="n">TARGETS</span> <span class="o">=</span> <span class="p">[</span><span class="s">'&lt;div class="float-left in-left col-priceBook'</span><span class="p">,</span>
           <span class="s">'&lt;div class="float-left in-right col-priceEarnings'</span><span class="p">,</span>
           <span class="s">'&lt;div class="float-left in-left col-numHoldings'</span><span class="p">,</span>
           <span class="s">'&lt;div class="float-left in-right col-beta3Yr'</span><span class="p">,</span>
           <span class="s">'&lt;div class="float-left in-left col-thirtyDaySecYield'</span><span class="p">,</span>
           <span class="s">'&lt;div class="float-left in-right col-standardDeviation3Yr'</span><span class="p">,</span>
           <span class="s">'&lt;div class="float-left in-left col-twelveMonTrlYld'</span><span class="p">]</span>


<span class="n">GROUPS</span><span class="o">=</span> <span class="p">{</span>
 <span class="s">'Materials'</span><span class="p">:</span> <span class="s">'Industrials'</span><span class="p">,</span>
 <span class="s">'Communication'</span><span class="p">:</span><span class="s">'Telecommunications'</span><span class="p">,</span>
 <span class="s">'Insurance'</span><span class="p">:</span> <span class="s">'Financials'</span><span class="p">,</span>
 <span class="s">'Diversified Financials'</span><span class="p">:</span>  <span class="s">'Financials'</span><span class="p">,</span>
 <span class="s">'Capital Goods'</span><span class="p">:</span><span class="s">'Industrials'</span><span class="p">,</span>
 <span class="s">'Banks'</span> <span class="p">:</span> <span class="s">'Financials'</span><span class="p">,</span>
 <span class="s">'Consumer Services'</span><span class="p">:</span> <span class="s">'Consumer Discretionary'</span><span class="p">,</span>
 <span class="s">'Transportation'</span><span class="p">:</span> <span class="s">'Utilities'</span><span class="p">,</span>
 <span class="s">'Food Bevg Tobacco'</span><span class="p">:</span> <span class="s">'Consumer Staples'</span><span class="p">}</span>



<span class="n">board_categories</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Consumer Discretionary'</span><span class="p">,</span>
 <span class="s">'Information Technology'</span><span class="p">,</span>
 <span class="s">'Consumer Staples'</span><span class="p">,</span>
 <span class="s">'Financials'</span><span class="p">,</span>
 <span class="s">'Industrials'</span><span class="p">,</span>
 <span class="s">'Energy'</span><span class="p">,</span>
 <span class="s">'Utilities'</span><span class="p">,</span>
 <span class="s">'Real Estate'</span><span class="p">,</span>
 <span class="s">'Health Care'</span><span class="p">,</span>
 <span class="s">'Telecommunications'</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">locate</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">html</span><span class="p">):</span>
    
    
    
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">html</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
            <span class="k">print</span> <span class="p">(</span><span class="s">'line {} </span><span class="se">\n</span><span class="s"> target {}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">target</span><span class="p">))</span>
            <span class="k">print</span> <span class="p">()</span>
            <span class="k">return</span> <span class="n">i</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span> <span class="p">(</span><span class="s">'cannot find {}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">target</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">None</span>
    
<span class="k">def</span> <span class="nf">extract</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">html</span><span class="p">):</span>
    <span class="c1"># print (html[i:i+10])
</span>    <span class="k">return</span> <span class="n">html</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">],</span> <span class="n">html</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">5</span><span class="p">],</span> <span class="n">html</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">9</span><span class="p">]</span>    


<span class="k">def</span> <span class="nf">parse_javascript</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    
    <span class="n">start_ind</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">end_ind</span> <span class="o">=</span> <span class="p">[]</span>
    
    
    <span class="n">ranking</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="s">'{'</span>  <span class="o">==</span> <span class="n">c</span><span class="p">:</span>
            <span class="n">start_ind</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s">'}'</span> <span class="o">==</span> <span class="n">c</span><span class="p">:</span>
            <span class="n">end_ind</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
            
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">start_ind</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">end_ind</span><span class="p">)</span>        
    <span class="k">for</span> <span class="n">s</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">start_ind</span><span class="p">,</span> <span class="n">end_ind</span><span class="p">):</span>
        <span class="c1"># print (html[i][s:e])
</span>        <span class="n">items</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">s</span><span class="p">:</span><span class="n">e</span><span class="p">].</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">)</span>
        
        <span class="n">value</span> <span class="o">=</span> <span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">split</span><span class="p">(</span><span class="s">':'</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">findall</span><span class="p">(</span><span class="s">'\w+'</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="n">ranking</span><span class="p">[</span><span class="s">'category'</span><span class="p">].</span><span class="n">append</span><span class="p">(</span><span class="s">' '</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        
        <span class="n">value</span> <span class="o">=</span> <span class="n">items</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">split</span><span class="p">(</span><span class="s">':'</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">ranking</span><span class="p">[</span><span class="s">'percentage'</span><span class="p">].</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">re</span><span class="p">.</span><span class="n">findall</span><span class="p">(</span><span class="s">'\d+\.\d+'</span><span class="p">,</span> <span class="n">value</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">ranking</span><span class="p">[</span><span class="s">'rank'</span><span class="p">].</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">split</span><span class="p">(</span><span class="s">':'</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
    
        
    
    <span class="k">print</span> <span class="p">(</span><span class="s">'found %d categories'</span> <span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">start_ind</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">ranking</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'weblinks.txt'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">links</span>  <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">readlines</span><span class="p">()</span>
    
    
    
    <span class="n">data</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span> 
    
    <span class="n">categories</span> <span class="o">=</span> <span class="p">[]</span>
     
    <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">links</span><span class="p">:</span>
        <span class="n">link</span> <span class="o">=</span> <span class="n">link</span><span class="p">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
        <span class="n">country</span> <span class="o">=</span> <span class="n">link</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">'/'</span><span class="p">)</span>
        
        <span class="n">myURL</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">link</span><span class="p">)</span>
        <span class="n">html</span> <span class="o">=</span> <span class="n">myURL</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">html</span> <span class="o">=</span> <span class="n">html</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">)</span>
        <span class="n">html</span> <span class="o">=</span> <span class="n">html</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
        
        <span class="n">target</span> <span class="o">=</span> <span class="s">'var tabsSectorDataTable =[{"name":'</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">locate</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">html</span><span class="p">)</span>
        
        <span class="n">ranking</span> <span class="o">=</span> <span class="n">parse_javascript</span><span class="p">(</span><span class="n">html</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        
        <span class="c1"># find all possible categories
</span>        <span class="c1"># for category in ranking['category']:
</span>        <span class="c1">#     if category not in categories:
</span>        <span class="c1">#         categories.append(category)
</span>                

        
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">TARGETS</span><span class="p">):</span>
    
            <span class="n">i</span> <span class="o">=</span> <span class="n">locate</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">html</span><span class="p">)</span>
            
            <span class="n">metric</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">extract</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">html</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">data</span><span class="p">[</span><span class="s">'country'</span><span class="p">].</span><span class="n">append</span><span class="p">(</span><span class="n">country</span><span class="p">)</span>
                <span class="n">data</span><span class="p">[</span><span class="s">'dates'</span><span class="p">].</span><span class="n">append</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
                
            <span class="n">data</span><span class="p">[</span><span class="n">metric</span><span class="p">].</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            
        
        <span class="n">percentages</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">p</span>  <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ranking</span><span class="p">[</span><span class="s">'category'</span><span class="p">],</span> <span class="n">ranking</span><span class="p">[</span><span class="s">'percentage'</span><span class="p">]):</span>
            
            <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">GROUPS</span><span class="p">:</span>
                <span class="n">c</span> <span class="o">=</span> <span class="n">GROUPS</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
                
            <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">board_categories</span><span class="p">:</span>
                <span class="n">percentages</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">+=</span> <span class="n">p</span>
                    
                
        <span class="k">print</span> <span class="p">(</span><span class="s">'check sum: '</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">percentages</span><span class="p">.</span><span class="n">values</span><span class="p">()))</span>
        
        
        <span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="n">board_categories</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="n">category</span><span class="p">].</span><span class="n">append</span><span class="p">(</span><span class="n">percentages</span><span class="p">[</span><span class="n">category</span><span class="p">])</span>
                


    
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">data</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">print</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
    
    <span class="n">table</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        
    <span class="n">table</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">'etf_Statistics.csv'</span><span class="p">)</span>  
        

</code></pre></div></div> <h3 id="visualization">Visualization</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">geopandas</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="c1"># import folium
</span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">Polygon</span>

<span class="k">def</span> <span class="nf">str_float</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="n">table</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'etf_Statistics.csv'</span><span class="p">)</span>

<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">[</span><span class="s">'30 Day SEC Yield'</span><span class="p">,</span>
       <span class="s">'Standard Deviation (3y)'</span><span class="p">,</span>
       <span class="s">'12m Trailing Yield'</span><span class="p">]:</span>
    
    <span class="n">table</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">c</span><span class="p">].</span><span class="nb">apply</span><span class="p">(</span><span class="n">str_float</span><span class="p">)</span>
    



<span class="c1"># Read the geopandas dataset
</span><span class="n">world</span> <span class="o">=</span> <span class="n">geopandas</span><span class="p">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">geopandas</span><span class="p">.</span><span class="n">datasets</span><span class="p">.</span><span class="n">get_path</span><span class="p">(</span><span class="s">'naturalearth_lowres'</span><span class="p">))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span><span class="s">'name'</span><span class="p">:</span> <span class="p">[</span><span class="s">'Hong Kong'</span><span class="p">,</span> <span class="s">'Singapore'</span><span class="p">],</span>
     <span class="s">'geometry'</span><span class="p">:</span> <span class="p">[</span><span class="n">Polygon</span><span class="p">([(</span><span class="mf">111.177216</span><span class="p">,</span> <span class="mf">19.302711</span><span class="p">),</span>
                           <span class="p">(</span><span class="mf">117.177216</span><span class="p">,</span> <span class="mf">19.302711</span><span class="p">),</span>
                           <span class="p">(</span><span class="mf">117.177216</span><span class="p">,</span> <span class="mf">25.302711</span><span class="p">),</span>
                           <span class="p">(</span><span class="mf">111.177216</span><span class="p">,</span> <span class="mf">25.302711</span><span class="p">)]),</span>
                  <span class="n">Polygon</span><span class="p">([(</span><span class="mf">102.177216</span><span class="p">,</span> <span class="mf">2.302711</span><span class="p">),</span>
                           <span class="p">(</span><span class="mf">104.177216</span><span class="p">,</span> <span class="mf">2.302711</span><span class="p">),</span>
                           <span class="p">(</span><span class="mf">104.177216</span><span class="p">,</span> <span class="mf">0.302711</span><span class="p">),</span>
                           <span class="p">(</span><span class="mf">102.177216</span><span class="p">,</span> <span class="mf">0.302711</span><span class="p">)])</span>
                  <span class="p">]})</span>

<span class="n">world</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">concat</span><span class="p">((</span><span class="n">world</span><span class="p">,</span> <span class="n">df</span><span class="p">))</span>

<span class="k">print</span><span class="p">(</span><span class="n">world</span><span class="p">.</span><span class="n">head</span><span class="p">())</span>


<span class="n">names</span> <span class="o">=</span> <span class="n">world</span><span class="p">.</span><span class="n">name</span><span class="p">.</span><span class="n">tolist</span><span class="p">()</span>


<span class="n">translation</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">table</span><span class="p">[</span><span class="s">'country'</span><span class="p">]:</span>
    <span class="c1"># print ('------------------')
</span>    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
        <span class="n">name2</span> <span class="o">=</span> <span class="n">name</span><span class="p">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">name2</span> <span class="o">=</span> <span class="n">name2</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">' '</span><span class="p">,</span> <span class="s">'-'</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">name2</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
            <span class="n">translation</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">name</span>
            <span class="k">break</span>
        
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span>
        
<span class="c1"># have to specify the country's name for some        
</span><span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">table</span><span class="p">[</span><span class="s">'country'</span><span class="p">]:</span>
    
    <span class="k">if</span> <span class="s">'sp-500'</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
        <span class="n">translation</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="s">'United States of America'</span>
        
    <span class="k">if</span> <span class="s">'uae'</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
        <span class="n">translation</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="s">'United Arab Emirates'</span>
    <span class="k">if</span> <span class="s">'287286'</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
        <span class="n">translation</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="s">'Argentina'</span>
      
<span class="n">ind</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="s">'country'</span><span class="p">])</span> <span class="k">if</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">translation</span><span class="p">]</span>        
        
<span class="n">table</span> <span class="o">=</span> <span class="n">table</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">ind</span><span class="p">,:]</span>
        
<span class="n">table</span><span class="p">[</span><span class="s">'country'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">translation</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">table</span><span class="p">[</span><span class="s">'country'</span><span class="p">]]</span>

<span class="n">table2</span> <span class="o">=</span> <span class="n">world</span><span class="p">.</span><span class="n">merge</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s">"left"</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s">'name'</span><span class="p">],</span> <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s">'country'</span><span class="p">])</span>


<span class="n">plt</span><span class="p">.</span><span class="n">close</span><span class="p">(</span><span class="s">'all'</span><span class="p">)</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">table2</span><span class="p">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">9</span><span class="p">:]:</span>
    <span class="c1"># plt.figure()
</span>    <span class="k">with</span> <span class="n">plt</span><span class="p">.</span><span class="n">style</span><span class="p">.</span><span class="n">context</span><span class="p">((</span><span class="s">"seaborn"</span><span class="p">,</span> <span class="s">"ggplot"</span><span class="p">)):</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">table2</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">c</span><span class="p">,</span>
                    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span>
                    <span class="n">edgecolor</span><span class="o">=</span><span class="s">"black"</span><span class="p">,</span>
                    <span class="n">legend</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                    <span class="n">legend_kwds</span><span class="o">=</span><span class="p">{</span><span class="s">"label"</span><span class="p">:</span> <span class="n">c</span><span class="p">,</span> <span class="s">"orientation"</span><span class="p">:</span><span class="s">"horizontal"</span><span class="p">},</span>
                    <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="n">cm</span><span class="p">.</span><span class="n">seismic</span><span class="p">,</span>
                    <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">table2</span><span class="p">[</span><span class="n">c</span><span class="p">])</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
                    <span class="n">missing_kwds</span><span class="o">=</span><span class="p">{</span>
                                    <span class="s">"color"</span><span class="p">:</span><span class="s">"grey"</span><span class="p">,</span>
                                    <span class="s">"edgecolor"</span><span class="p">:</span><span class="s">"black"</span><span class="p">,</span>
                                    <span class="s">"hatch"</span><span class="p">:</span><span class="s">"---"</span><span class="p">,</span>
                                    <span class="s">"label"</span><span class="p">:</span><span class="s">"Missing Values"</span>
                                <span class="p">}</span>
                <span class="p">)</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">set_axis_off</span><span class="p">()</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="n">c</span> <span class="o">+</span> <span class="s">' '</span> <span class="o">+</span> <span class="n">table2</span><span class="p">[</span><span class="s">'dates'</span><span class="p">][</span><span class="n">np</span><span class="p">.</span><span class="n">invert</span><span class="p">(</span><span class="n">table2</span><span class="p">[</span><span class="s">'dates'</span><span class="p">].</span><span class="n">isna</span><span class="p">())].</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        
        <span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'/'</span><span class="p">,</span> <span class="s">'_'</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">' '</span><span class="p">,</span> <span class="s">'_'</span><span class="p">)</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">savefig</span> <span class="p">(</span><span class="n">c</span> <span class="o">+</span> <span class="s">".png"</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>


</code></pre></div></div> <h2 id="references">References</h2> <ul> <li>https://www.ishares.com/us/products/287286/</li> <li>https://www.ishares.com/us/products/239689/ishares-msci-turkey-etf</li> <li>https://www.ishares.com/us/products/239688/ishares-msci-thailand-capped-etf</li> <li>https://www.ishares.com/us/products/239618/ishares-msci-chile-capped-etf</li> <li>https://www.ishares.com/us/products/239621/ishares-msci-denmark-capped-etf</li> <li>https://www.ishares.com/us/products/239647/ishares-msci-finland-capped-etf</li> <li>https://www.ishares.com/us/products/239661/ishares-msci-indonesia-etf</li> <li>https://www.ishares.com/us/products/239662/ishares-msci-ireland-capped-etf</li> <li>https://www.ishares.com/us/products/239663/ishares-msci-israel-capped-etf</li> <li>https://www.ishares.com/us/products/239673/ishares-msci-norway-capped-etf</li> <li>https://www.ishares.com/us/products/239672/ishares-msci-new-zealand-capped-etf</li> <li>https://www.ishares.com/us/products/239675/ishares-msci-philippines-etf</li> <li>https://www.ishares.com/us/products/239676/ishares-msci-poland-capped-etf</li> <li>https://www.ishares.com/us/products/239606/ishares-msci-all-peru-capped-etf</li> <li>https://www.ishares.com/us/products/239677/ishares-msci-russia-capped-etf</li> <li>https://www.ishares.com/us/products/239607/ishares-msci-australia-etf</li> <li>https://www.ishares.com/us/products/239615/ishares-msci-canada-etf</li> <li>https://www.ishares.com/us/products/239684/ishares-msci-sweden-etf</li> <li>https://www.ishares.com/us/products/239650/ishares-msci-germany-etf</li> <li>https://www.ishares.com/us/products/239657/ishares-msci-hong-kong-etf</li> <li>https://www.ishares.com/us/products/239665/ishares-msci-japan-etf</li> <li>https://www.ishares.com/us/products/239610/ishares-msci-belgium-capped-etf</li> <li>https://www.ishares.com/us/products/239669/ishares-msci-malaysia-etf</li> <li>https://www.ishares.com/us/products/239671/ishares-msci-netherlands-etf</li> <li>https://www.ishares.com/us/products/239609/ishares-msci-austria-capped-etf</li> <li>https://www.ishares.com/us/products/239683/ishares-msci-spain-capped-etf</li> <li>https://www.ishares.com/us/products/239648/ishares-msci-france-etf</li> <li>https://www.ishares.com/us/products/239678/ishares-msci-singapore-capped-etf</li> <li>https://www.ishares.com/us/products/239686/ishares-msci-taiwan-etf</li> <li>https://www.ishares.com/us/products/239690/ishares-msci-united-kingdom-etf</li> <li>https://www.ishares.com/us/products/239670/ishares-msci-mexico-capped-etf</li> <li>https://www.ishares.com/us/products/239681/ishares-msci-south-korea-capped-etf</li> <li>https://www.ishares.com/us/products/239612/ishares-msci-brazil-capped-etf</li> <li>https://www.ishares.com/us/products/239680/ishares-msci-south-africa-etf</li> <li>https://www.ishares.com/us/products/239536/ishares-china-largecap-etf</li> <li>https://www.ishares.com/us/products/254562/ishares-msci-colombia-capped-etf</li> <li>https://www.ishares.com/us/products/239758/ishares-india-50-etf</li> <li>https://www.ishares.com/us/products/271542/ishares-msci-saudi-arabia-capped-etf</li> <li>https://www.ishares.com/us/products/264273/ishares-msci-qatar-capped-etf</li> <li>https://www.ishares.com/us/products/239726/ishares-core-sp-500-etf</li> <li>https://www.ishares.com/us/products/264275/ishares-msci-uae-capped-etf</li> </ul> </div> <div id="disqus_thread"></div> </article> <article class="card" itemscope itemtype="http://schema.org/BlogPosting"> <div class="card-body" itemprop="articleBody"> <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"> <div class="card-header"> <span class="title"> <i class="fa fa-share"></i> Share this to: </span> </div> <div id="share-bar"> <div class="share-buttons"> <a href="https://www.facebook.com/sharer/sharer.php?u=/finance/2021/10/05/world_equities_market_valuation/" onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook" > <i class="fa fa-facebook-official share-button"> facebook</i> </a> <a href="https://twitter.com/intent/tweet?text=World equity markets valuation&url=/finance/2021/10/05/world_equities_market_valuation/" onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter" > <i class="fa fa-twitter share-button"> twitter</i> </a> <a href="https://plus.google.com/share?url=/finance/2021/10/05/world_equities_market_valuation/" onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Google+" > <i class="fa fa-google-plus share-button"> google</i> </a> <a href="https://www.pinterest.com/pin/create/button/?url=/finance/2021/10/05/world_equities_market_valuation/" onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;" title="Share on Pinterest" > <i class="fa fa-pinterest-p share-button"> pinterest</i> </a> <a href="https://www.tumblr.com/share/link?url=/finance/2021/10/05/world_equities_market_valuation/" onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;" title="Share on Tumblr" > <i class="fa fa-tumblr share-button"> tumblr</i> </a> <a href="http://www.reddit.com/submit?url=/finance/2021/10/05/world_equities_market_valuation/" onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;" title="Share on Reddit" > <i class="fa fa-reddit-alien share-button"> reddit</i> </a> <a href="https://www.linkedin.com/shareArticle?mini=true&url=/finance/2021/10/05/world_equities_market_valuation/&title=World equity markets valuation&summary=&source=Wilson Fok" onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn" > <i class="fa fa-linkedin share-button"> linkedin</i> </a> <a href="mailto:?subject=World equity markets valuation&amp;body=Check out this site /finance/2021/10/05/world_equities_market_valuation/" title="Share via Email" > <i class="fa fa-envelope share-button"> email</i> </a> </div> </div> </div> </article> <script> var disqus_config = function () { this.page.url = "/finance/2021/10/05/world_equities_market_valuation/"; /* Replace PAGE_URL with your page's canonical URL variable */ this.page.identifier = "/finance/2021/10/05/world_equities_market_valuation"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */ }; (function () { /* DON'T EDIT BELOW THIS LINE */ var d = document, s = d.createElement('script'); s.src = 'https://.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a> </noscript></div> </div> <!-- End of row--> <div class="row"> <div class="col-md-4"> <div class="card"> <div class="card-header"> About </div> <div class="card-body"> <!-- Your Bio --> <p class="author_bio"> Hello, My name is Wilson Fok. I love to extract useful insights and knowledge from big data. Constructive feedback and insightful comments are very welcome!</p> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Categories </div> <div class="card-body text-dark"> <div id="#Finance"></div> <li class="tag-head"> <a href="/blog/categories/Finance">Finance</a> </li> <a name="Finance"></a> <div id="#NLP"></div> <li class="tag-head"> <a href="/blog/categories/NLP">NLP</a> </li> <a name="NLP"></a> <div id="#Deep_Learning"></div> <li class="tag-head"> <a href="/blog/categories/Deep_Learning">Deep_Learning</a> </li> <a name="Deep_Learning"></a> <div id="#Others"></div> <li class="tag-head"> <a href="/blog/categories/Others">Others</a> </li> <a name="Others"></a> <div id="#Reading"></div> <li class="tag-head"> <a href="/blog/categories/Reading">Reading</a> </li> <a name="Reading"></a> <div id="#Toastmasters"></div> <li class="tag-head"> <a href="/blog/categories/Toastmasters">Toastmasters</a> </li> <a name="Toastmasters"></a> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Useful Links </div> <div class="card-body text-dark"> <li > <a href="/about">About Me</a> </li> <li > <a href="/blog">Blog</a> </li> <li > <a href="/blog/categories">Categories</a> </li> <li > <a href="/gallery">Gallery</a> </li> <li > <a href="/contact">Contact Me</a> </li> </div> </div> </div> </div> </div> <footer> <p> Powered by Jekyll. Hosted on <a href="https://pages.github.com">Github</a>. Subscribe via <a href=" /feed.xml ">RSS <i class="fa fa-rss" aria-hidden="true"></i> </a> </p> </footer> </div> <script> var options = { classname: 'my-class', id: 'my-id' }; var nanobar = new Nanobar( options ); nanobar.go( 30 ); nanobar.go( 76 ); nanobar.go(100); </script> <!-- <div hidden id="snipcart" data-api-key="Y2I1NTAyNWYtMTNkMy00ODg0LWE4NDItNTZhYzUxNzJkZTI5NjM3MDI4NTUzNzYyMjQ4NzU0"></div> <script src="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.js" defer></script> --> <script src="/assets/js/mode-switcher.js"></script> <script src="/assets/js/slideshow.js"></script> </body> </html>
