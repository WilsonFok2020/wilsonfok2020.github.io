<!DOCTYPE html> <html lang=" en "><head> <meta charset="utf-8"> <title>Wilson Fok - A data science enthusiast</title> <meta http-equip="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <meta name="description" content="MongoDB Background" /> <meta name="keywords" content="MongoDB Background, Wilson Fok, Others" /> <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml"> <meta content="" property="fb:app_id"> <meta content="Wilson Fok" property="og:site_name"> <meta content="MongoDB Background" property="og:title"> <meta content="article" property="og:type"> <meta content="MongoDB Background" property="og:description"> <meta content="/others/2024/09/26/mongoDB_background/" property="og:url"> <meta content="2024-09-26T00:00:00+08:00" property="article:published_time"> <meta content="/about/" property="article:author"> <meta content="/assets/img/posts//assets/images/Mongodb/taxonomy_facet_example.png" property="og:image"> <meta content="Others" property="article:section"> <meta name="twitter:card" content="summary"> <meta name="twitter:site" content="@"> <meta name="twitter:creator" content="@"> <meta name="twitter:title" content="MongoDB Background"> <meta content="Wilson Fok" property="og:site_name"> <meta name="twitter:url" content="/others/2024/09/26/mongoDB_background/"> <meta name="twitter:description" content="Hello, My name is Wilson Fok. I love to extract useful insights and knowledge from big data. I also like to make new friends and connections. Let's connect! "> <!-- load layout style css --> <link rel="stylesheet" href="/assets/css/main.css" /> <link rel="stylesheet" href="/assets/css/custom-style.css" /> <link rel="stylesheet" href="/assets/bower_components/lightgallery/dist/css/lightgallery.min.css"/> <link rel="stylesheet" href="/assets/bower_components/bootstrap/dist/css/bootstrap.min.css" /> <link rel="stylesheet" href="/assets/bower_components/font-awesome/web-fonts-with-css/css/fontawesome-all.min.css" /> <!-- Favicon --> <link rel="icon" href="/assets/img/favicon.ico" type="image/gif" sizes="16x16"> <!-- Jquery --> <!-- one or more of the below scripts does fancy word animation and dropdown menu --> <script src="/assets/extra_js/jquery-3.4.1.min.js"></script> <script src="/assets/extra_js/picturefill min/picturefill.min.js"></script> <script src="/assets/extra_js/instantsearch min/instantsearch.min.js"></script> <script src="/assets/extra_js/moment min/moment.min.js"></script> <script src="/assets/bower_components/jquery.easing/jquery.easing.min.js"></script> <script src="/assets/bower_components/bootstrap/dist/js/bootstrap.bundle.min.js"></script> <script src="/assets/bower_components/jquery-mousewheel/jquery.mousewheel.min.js"></script> <script src="/assets/bower_components/lightgallery/dist/js/lightgallery-all.min.js"></script> <script src="/assets/bower_components/imagesloaded/imagesloaded.pkgd.min.js"></script> <script src="/assets/bower_components/nanobar/nanobar.min.js"></script> <script src="/assets/bower_components/typewrite/dist/typewrite.min.js"></script> </head><body> <div class="container-fluid"><header> <script src="https://cdn.knightlab.com/libs/juxtapose/latest/js/juxtapose.min.js"></script> <link rel="stylesheet" href="https://cdn.knightlab.com/libs/juxtapose/latest/css/juxtapose.css"> <div class="col-lg-12"> <div class="row"> <nav class="navbar navbar-expand-lg fixed-top navbar-dark " id="topNav"> <!-- <a class="navbar-brand" href="#">Wilson Fok</a> --> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="/">Wilson Fok</a> <div class="collapse navbar-collapse" id="navbarNav"> <ul class="navbar-nav"> <li class="nav-item"> <a class="nav-link" href="/about">About Me</a> </li> <li class="nav-item"> <a class="nav-link" href="/blog">Blog</a> </li> <li class="nav-item"> <a class="nav-link" href="/blog/categories">Categories</a> </li> <li class="nav-item"> <a class="nav-link" href="/gallery">Gallery</a> </li> <li class="nav-item"> <a class="nav-link" href="/contact">Contact Me</a> </li> </ul> </div> <ul class="nav justify-content-end"> <!-- <li class="nav-item"> <a class="nav-link" id="search-icon" href="/search/"><i class="fa fa-search" aria-hidden="true"></i></a> </li> --> <li class="nav-item"> <input class="nav-link switch" id="theme-toggle" onclick="modeSwitcher() "type="checkbox" name="checkbox" > </li> </ul> </nav> </div> </div> </header><div class="col-lg-12"> <!-- Blog Post Breadcrumbs --><div class="col-lg-12"> <nav aria-label="breadcrumb" role="navigation"> <ol class="breadcrumb"> <li class="breadcrumb-item"> <a href="/blog"><i class="fa fa-home" aria-hidden="true"></i></a> </li> <li class="breadcrumb-item active" aria-current="page"><a href="/others/2024/09/26/mongoDB_background/">MongoDB Background</a></li> </ol> </nav> </div><div class="row" id="blog-post-container"> <div class="col-lg-8 offset-md-2"><article class="card" itemscope itemtype="http://schema.org/BlogPosting"> <div class="card-header"> <h1 class="post-title" itemprop="name headline">MongoDB Background</h1> <p></p> <h6 class="post-meta"> <i> Summary : MongoDB Background</i> </h6> <p class="post-summary">Posted by : <img src="/assets/img/profile.png" class="author-profile-img"> <span itemprop="author" itemscope itemtype="http://schema.org/Person"> <span itemprop="name">Wilson Fok</span> </span> on <time datetime="2024-09-26 00:00:00 +0800" itemprop="datePublished">Sep 26, 2024</time> </p> <span class="disqus-comment-count" data-disqus-identifier="/others/2024/09/26/mongoDB_background/"></span> <div class="post-categories"> Category : <a href="/blog/categories/Others">Others</a> </div> </div> <div class="card-body" itemprop="articleBody"> <p>Dear readers,</p> <p>This is my introductory course on some basic concepts on database, searches, and optimization. MongoDB is a NoSQL database that stores data in flexible, JSON-like documents, rather than the traditional table-based relational database structure. This allows for more dynamic schemas, where fields can vary between documents, and data can be nested in complex hierarchies. ###Key Features of MongoDB:</p> <ol> <li>Document-Oriented Storage: MongoDB stores data in BSON (binary JSON) format, which means data can be represented in a rich, hierarchical structure. This makes it more adaptable to changing data models.</li> </ol> <h3 id="what-is-a-data-model">What is a data model?</h3> <h3 id="conceptual-data-models">Conceptual data models</h3> <p>These model types provide a high-level, conceptual view of your data. They identify key entities—like customers, products, orders, and payments—and show how these entities relate to each other. This model is designed to help business stakeholders understand how different parts of the data interact without diving into technical details.</p> <ul> <li>Example: For a retail company, a conceptual data model might include categories like customers, products, orders, and payments. The relationships between these categories would be mapped out visually to help stakeholders see how the data from different parts of the business interact without getting into specifics like data types or storage methods.</li> </ul> <h3 id="logical-data-models">Logical data models</h3> <p>Logical data models build on the conceptual model by adding more detail. They define the data elements, their attributes, and the relationships between them in a way that aligns more closely with how the data will be implemented in a database. This model bridges the gap between business needs and technical design, making it easier for IT teams to plan the database structure.</p> <ul> <li>Example: Continuing with the retail company example, a logical data model would define specific attributes for each category defined in the conceptual model. For instance, the customer category might include attributes like customer ID, name, email, and address. The order category could include details like order ID, order date, customer ID, and total amount. This additional detail translates business concepts into a structured database design, though it doesn’t yet address the physical aspects.</li> </ul> <h3 id="physical-data-models-electronic">Physical data models (Electronic)</h3> <p>Physical data models provide the most detail. They take the logical model and turn it into a specific framework for storing and managing the data within a particular database system. This includes defining the structure of tables, the types of data that will be stored in each column, and how the data will be indexed and accessed. The physical model optimizes the database for performance and maintains accurate data relationships.</p> <ul> <li>Example: For our hypothetical retail company, the physical data model would translate the logical model into a concrete database design. The customer category might become a table named “Customers,” with fields for customer information like ID, name, email, and address. Similarly, the order category would be “Orders,” containing details like order date, customer ID, and total amount. The physical model also defines how these tables interact within the database to ensure efficient data retrieval and integrity.</li> </ul> <ol> <li>Scalability: MongoDB is designed to scale horizontally, which means you can distribute data across multiple servers. This is especially useful for handling large volumes of data and high traffic loads.</li> <li>Flexibility: Unlike traditional relational databases that require a predefined schema, MongoDB allows for flexible schemas (mixture of different data variable types, inconsistent number of fields, etc), making it easier to handle data that doesn’t fit neatly into a predefined structure.</li> <li>High Performance: MongoDB is optimized for read and write performance, and it supports indexing and querying that can improve data access speeds.</li> <li>Distributed Database: MongoDB is built for distributed systems, with features like replication, sharding (splitting a large database into smaller partitions and storing them in various locations), and automatic failover, making it highly resilient and available.</li> <li>Aggregation Framework: MongoDB provides a powerful aggregation framework that allows for complex data processing and transformation directly within the database.</li> <li>Integration with Modern Development Stacks: MongoDB integrates well with many modern development environments, including JavaScript, Python, and Node.js, making it popular among developers building web applications.</li> </ol> <p>###Why MongoDB is Popular:</p> <ol> <li>Ease of Use: MongoDB’s flexible document model is more aligned with how developers think about data, especially in web and mobile applications. This makes it easier to use and faster to develop with compared to traditional relational databases.</li> <li>Scalability: As data grows, MongoDB’s ability to scale horizontally by adding more servers allows businesses to manage large datasets without significant performance degradation.</li> <li>Flexible Schema: The ability to store various data types and structures in the same collection without needing to define a strict schema upfront makes MongoDB ideal for rapidly evolving applications.</li> <li>Strong Community and Ecosystem: MongoDB has a large and active community, extensive documentation, and a wide range of tools and integrations, making it a popular choice for developers and companies.</li> <li>Cloud-Native: MongoDB Atlas, the cloud version of MongoDB, offers a managed service that abstracts away the complexities of database management, making it easier for developers to deploy and scale databases in the cloud.</li> <li> <p>Support for Big Data and Real-Time Applications: MongoDB’s performance characteristics and scalability make it well-suited for big data applications, real-time analytics, and other modern use cases where traditional databases may struggle. MongoDB’s combination of flexibility, performance, and scalability has made it one of the most popular NoSQL databases, especially in environments where developers need to move quickly and handle large, complex datasets.</p> </li> <li>I have read through its documentation and tutorials on MongoDB website (https://www.mongodb.com/). They are well-suited for beginners like myself and offer MongoDB University courses <strong>for free</strong>.</li> </ol> <h3 id="some-basic-differences-between-mongodb-nosql-vs-sql-database">Some basic differences between MongoDB (NoSQL) vs SQL database</h3> <p>SQL is very fast for lookup, and for adding new rows, which makes it very suitable for a situation where we need to often add and remove new samples. However, its schema is rigid. In other words, its columns are preset, so adding or removing a field can be tricky. Also, its schema can only handle single variable type within a field, which means it can be less flexible.</p> <p>On the other hand, MongoDB lets us mix multiple variable types in the same field or add or remove new columns, with each entry can have different number of fields. Apart from the standard integer, string, double, MongoDB uses unique variable types. For example, ID Key, ISODATE, etc. Each sample is a document. Many related or similar documents grouped together are called a collection. Many related or similar collections grouped together are called a database and putting several databases together are called a cluster. It can scale easily. Despite its flexibility, MongoDB can enforce constraints on its schema and validate its documents against its constraints.</p> <h3 id="how-mongodb-handles-relationships">How MongoDB handles relationships?</h3> <p>In MongoDB, we have 3 different ways to combine a key (unique) to a value (information). The first way is one-to-one. This is most useful when we need to look up a unique record. Say we identify this particular record with its own unique id that is automatically generated when we insert it into a database. The second way is one-to-many. This is most useful when we have multiply items inside an array for a field. We can search through them. For example, a single record possesses multiple tags or labels. The last way is many-to-many. It is very paramount that we understand the purpose and the functional requirements of database. The four functional pillars of a good database are atomicity, consistency, isolation and durability.</p> <ul> <li>Atomicity = All operations will either succeed or fail together.</li> <li>Consistency = All changes made by operations are consistent with database constraints or meet the schema validation rules.</li> <li>Isolation = Multiple transactions can happen at the same time without affecting the outcome of other transaction.</li> <li>Durability = All of the changes that are made by operations in a transaction will persist, no matter what.</li> </ul> <h3 id="why-do-we-use-indexing">Why do we use indexing?</h3> <p>Indexing in MongoDB is a powerful feature that enhances the efficiency of query operations by allowing the database to quickly locate and access the data needed without scanning the entire collection. This can significantly improve query performance, especially in large datasets.</p> <h3 id="benefits-of-indexing-in-mongodb">Benefits of Indexing in MongoDB:</h3> <ol> <li>Improved Query Performance: Indexes allow MongoDB to search for records more quickly by narrowing down the search space. Instead of scanning the entire collection, the database can directly access the indexed fields, resulting in faster query execution.</li> <li>Reduced Resource Consumption: Efficient indexing reduces the CPU and memory load on the database server by minimizing the amount of data that needs to be processed during queries.</li> <li>Enhanced Sorting: Indexes can also improve the performance of sort operations. If a query requests data in a sorted order based on an indexed field, MongoDB can retrieve the data in the desired order without additional sorting, saving time and resources.</li> <li>Faster Data Aggregation: Indexes can accelerate the performance of aggregation operations that involve filtering or sorting, allowing for quicker insights and data analysis.</li> <li>Support for Unique Constraints: MongoDB indexes can enforce unique constraints, ensuring that a particular field or combination of fields in a collection is unique across all documents. This is useful for maintaining data integrity, such as ensuring unique email addresses in a user collection.</li> <li>Geospatial Queries: MongoDB supports geospatial indexes, enabling efficient querying of location-based data. This is beneficial for applications that involve mapping, geolocation services, or any feature requiring spatial data processing.</li> <li>Text Search Optimization: MongoDB offers text indexes that optimize the performance of text search queries, allowing for efficient full-text search within documents.</li> </ol> <h3 id="how-indexing-is-done-in-mongodb">How Indexing is Done in MongoDB:</h3> <p>Creating and managing indexes in MongoDB is straightforward. Here’s how you can do it:</p> <ol> <li>Single Field Index: The simplest form of an index is a single field index, which is created on a specific field in a collection. This is useful for queries that frequently filter or sort based on this field.</li> </ol> <p><img src="/assets/images/Mongodb/createIndex.png" alt="" width="1100px" /></p> <p>1 specifies ascending order, while -1 would specify descending order.</p> <p>When we query a database, instead of searching through all its documents, we can just search through this index. This saves time by searching in fewer places. However, if we have creates too many different indices, we may lose out especially we need to update them as well whenever we updates the underlying documents. Each update requires a write operation on the index too.</p> <p>So, we may want to let an index expire on its own after some time.</p> <p>TTL Index: A Time-To-Live (TTL) index can automatically remove documents from a collection after a certain period. db.collection.createIndex({ createdAt: 1 }, { expireAfterSeconds: 3600 })</p> <ul> <li> <p>Trick 1: create index that can be used to speed up the search. We create an index based on frequently observed queries on some of the fields. Then when we query, if its corresponding index exists, the search will automatically use it.</p> </li> <li> <p>Trick 2: indexing order matters. A rule of thumb is that we filter or use Boolean selection to reduce the number of documents or results as early as feasible. Then we perform more complicated / expensive operations, such as sorting.</p> </li> </ul> <h3 id="index-management">Index management</h3> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>* How to examine what indices built in the database so far?
* What happen if we are searching on the fields that have no index?
* How to remove redundant index?
</code></pre></div></div> <p>Let’s take a look with the explain method that delineates how MongoDB performs searches. Without an index is not going to stymie the search progress. MongoDB has different mode for finding the subset of documents that match the queries.</p> <p>COLLSCAN: collection scan is performed, without accessing the index</p> <p><img src="/assets/images/Mongodb/explain_collscan.png" alt="" width="1100px" /></p> <p>IXSCAN: indicate whether query uses index or not FETCH: read the documents SORT: sort the search results in memory</p> <p><img src="/assets/images/Mongodb/explain_ixscan.png" alt="" width="1100px" /></p> <ul> <li>Trick: when we are only after some specific fields, we can use projection to display only the relevant fields and hide others.</li> </ul> <p><img src="/assets/images/Mongodb/projection_ex_index.png" alt="" width="1100px" /></p> <p><img src="/assets/images/Mongodb/explain_projection.png" alt="" width="1100px" /></p> <p>Furthermore, we can turn a single field index into multiple fields index (aka compound index) to make searching more than one field more efficient. However, the order of the items in the field matters to the efficiency, but not search results.</p> <p><img src="/assets/images/Mongodb/compound_index.png" alt="" width="1100px" /></p> <p>This MongoDB tutorial does not recommend users to delete indices when they become obsolete. This is because we often can delete the index that we still need. Instead of deleting it, we can just hide the index from use and check to see if anything else breaks as a result.</p> <p>Delete = dropIndex hide index = hideIndex</p> <p><img src="/assets/images/Mongodb/hide.png" alt="" width="1100px" /> <img src="/assets/images/Mongodb/delete.png" alt="" width="1100px" /></p> <h3 id="commonly-used-apis">Commonly Used APIs</h3> <p>We can use different filters . The chose of filters depend on the data type of the field that we are looking at.</p> <p>If it is just a plain and simple string, integer, float, double, etc, we can use pretty much anything.</p> <h5 id="logical-operators">Logical operators</h5> <p><img src="/assets/images/Mongodb/andOr.png" alt="" width="1100px" /></p> <p>Some field contain arrays. Arrays are data structure that inside itself, contains data or elements. If we want to search inside an array, we need to do this.</p> <p>We use the operator called elemMatch that looks up <strong>multiple fields and across every elements / all elements</strong>.</p> <p><img src="/assets/images/Mongodb/elemMatch.png" alt="" width="1100px" /> <img src="/assets/images/Mongodb/elemMatch_elements.png" alt="" width="1100px" /> <img src="/assets/images/Mongodb/insertOne.png" alt="" width="1100px" /></p> <p><strong>Many</strong> belongs to the family of bulk-write-method. It accesses multiple documents at once, with the benefit of reducing the number of round trips to the server and improved efficiency.</p> <p><img src="/assets/images/Mongodb/updateOne.png" alt="" width="1100px" /> <img src="/assets/images/Mongodb/updateOne_Code.png" alt="" width="1100px" /> <img src="/assets/images/Mongodb/upsert_q.png" alt="" width="1100px" /></p> <p>If we cannot find a document, we can create it with the desired fields by turning the upsert=True</p> <p><strong>Array</strong> is a special data structure, so we use push to append a new element to the array of existing elements.</p> <p><img src="/assets/images/Mongodb/updateMany.png" alt="" width="1100px" /> <img src="/assets/images/Mongodb/updateManyCode.png" alt="" width="1100px" /></p> <p>we can also use findAndModify to perform an update operation. This is helpful for keep track of statistics such as counts.</p> <p><img src="/assets/images/Mongodb/findAndModify.png" alt="" width="1100px" /> <img src="/assets/images/Mongodb/replaceOne.png" alt="" width="1100px" /></p> <p>NOTE: when input to the APIs is null / empty, the functions perform like we are working on all documents. CountDocuments counts all documents. DeleteMany deletes all documents. Find finds all documents.</p> <p><img src="/assets/images/Mongodb/countDocuments.png" alt="" width="1100px" /></p> <h3 id="referencing">Referencing</h3> <p>In MongoDB, we have two options for referencing. The first is embedding. Embedding duplicates the data entries such that each document is complete. The pros are we do not need to look elsewhere for the information, and it is fast. The cons are we can end up with a very large document with many redundancy. The second is referencing. Referencing does not duplicate the data, but it adds a OBJECTID in the document and we can search and link to the other documents to locate the information. However, this means that we search more slowly, and through more documents. But the document itself are smaller, without duplicate of information, easier to update and maintain proper records. Referencing is also closely related to the concept of data normalization.</p> <p><img src="/assets/images/Mongodb/ref.png" alt="" width="1100px" /> <img src="/assets/images/Mongodb/refTypes.png" alt="" width="1100px" /></p> <h3 id="atomicity">Atomicity</h3> <p>Whenever we are working with multiple documents, we can use session to ensure atomicity. For example, we like to transfer money from accouter holder A to account holder B, this transfer involves the deduction from A and the increment of B. we want to ensure that both operations succeed together or fail together, but not one succeeded and the other failed (for instance, money taken out from A but not put back in B).</p> <p><img src="/assets/images/Mongodb/session.png" alt="" width="1100px" /></p> <h3 id="what-is-aggregates">What is aggregates?</h3> <p>In MongoDB, the concept of <strong>aggregation</strong> refers to the process of processing data records and returning computed results. Aggregation operations group values from multiple documents together and can perform a variety of operations on the grouped data to return a single result. Aggregations are similar to SQL’s <code class="language-plaintext highlighter-rouge">GROUP BY</code> and <code class="language-plaintext highlighter-rouge">JOIN</code> operations, but they are more powerful and flexible.</p> <h3 id="key-concepts-of-aggregation-in-mongodb">Key Concepts of Aggregation in MongoDB</h3> <ol> <li><strong>Aggregation Pipeline:</strong> <ul> <li>The aggregation framework uses a concept called the “aggregation pipeline,” which is a series of stages that process the data. Each stage performs an operation on the input documents and passes the result to the next stage.</li> <li>The pipeline operates in a sequence, where the output of one stage becomes the input to the next.</li> <li>Example of an aggregation pipeline: <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">db.orders.aggregate(</span><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w"> </span><span class="err">$match:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">status:</span><span class="w"> </span><span class="s2">"shipped"</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">},</span><span class="w">       </span><span class="err">//</span><span class="w"> </span><span class="err">Stage</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span><span class="w"> </span><span class="err">Filter</span><span class="w"> </span><span class="err">documents</span><span class="w">
  </span><span class="p">{</span><span class="w"> </span><span class="err">$group:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">_id:</span><span class="w"> </span><span class="s2">"$customerId"</span><span class="p">,</span><span class="w"> </span><span class="err">total:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">$sum:</span><span class="w"> </span><span class="s2">"$amount"</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">},</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">Stage</span><span class="w"> </span><span class="mi">2</span><span class="err">:</span><span class="w"> </span><span class="err">Group</span><span class="w"> </span><span class="err">and</span><span class="w"> </span><span class="err">calculate</span><span class="w"> </span><span class="err">total</span><span class="w"> </span><span class="err">amount</span><span class="w">
  </span><span class="p">{</span><span class="w"> </span><span class="err">$sort:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">total:</span><span class="w"> </span><span class="mi">-1</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w">                 </span><span class="err">//</span><span class="w"> </span><span class="err">Stage</span><span class="w"> </span><span class="mi">3</span><span class="err">:</span><span class="w"> </span><span class="err">Sort</span><span class="w"> </span><span class="err">by</span><span class="w"> </span><span class="err">total</span><span class="w"> </span><span class="err">amount</span><span class="w"> </span><span class="err">in</span><span class="w"> </span><span class="err">descending</span><span class="w"> </span><span class="err">order</span><span class="w">
</span><span class="p">]</span><span class="err">)</span><span class="w">
</span></code></pre></div> </div> </li> </ul> </li> <li><strong>Stages in the Aggregation Pipeline:</strong> <strong>$match:</strong> Filters the documents to pass only those that match the specified conditions. Similar to the <code class="language-plaintext highlighter-rouge">WHERE</code> clause in SQL.</li> </ol> <p><img src="/assets/images/Mongodb/match.png" alt="" width="1100px" /></p> <p><strong>$group:</strong> Groups documents by a specified identifier (<code class="language-plaintext highlighter-rouge">_id</code>) and applies an aggregation function to the grouped data (e.g., sum, average). Similar to the <code class="language-plaintext highlighter-rouge">GROUP BY</code> clause in SQL.</p> <p><img src="/assets/images/Mongodb/group.png" alt="" width="1100px" /></p> <p><strong>$sort:</strong> Sorts the documents based on the specified field(s) and order (ascending or descending).</p> <p><img src="/assets/images/Mongodb/sort.png" alt="" width="1100px" /></p> <p><strong>$project:</strong> Reshapes each document in the stream, adding, removing, or transforming fields.</p> <p><img src="/assets/images/Mongodb/project.png" alt="" width="1100px" /></p> <p><strong>$limit:</strong> Limits the number of documents that are passed through the pipeline.</p> <p><img src="/assets/images/Mongodb/limit.png" alt="" width="1100px" /></p> <ul> <li><strong>$skip:</strong> Skips a specified number of documents, often used in conjunction with <code class="language-plaintext highlighter-rouge">$limit</code> to implement pagination. <ul> <li><strong>$unwind:</strong> Deconstructs an array field from the input documents to output a document for each element of the array. It is useful for dealing with arrays within documents. <strong>$lookup:</strong> Performs a left outer join to another collection in the same database to combine data from multiple sources, similar to SQL’s <code class="language-plaintext highlighter-rouge">JOIN</code> operation.</li> </ul> </li> </ul> <p><strong>$Set:</strong> Insert or modify the values of a field.</p> <p><img src="/assets/images/Mongodb/set.png" alt="" width="1100px" /></p> <ol> <li><strong>Aggregation Expressions:</strong> <ul> <li>Aggregation stages often include expressions to perform operations on fields, such as arithmetic, string manipulation, and conditional logic. Example: In the <code class="language-plaintext highlighter-rouge">$group</code> stage, you might use Accumulator such as <code class="language-plaintext highlighter-rouge">$sum</code>, <code class="language-plaintext highlighter-rouge">$avg</code>, <code class="language-plaintext highlighter-rouge">$max</code>, <code class="language-plaintext highlighter-rouge">$min</code>, <code class="language-plaintext highlighter-rouge">$count</code>,etc., to perform calculations on grouped documents.</li> </ul> </li> </ol> <p><img src="/assets/images/Mongodb/count.png" alt="" width="1100px" /></p> <ol> <li><strong>Example Scenarios:</strong> <ul> <li><strong>Calculate Total Sales by Product:</strong> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">db.sales.aggregate(</span><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w"> </span><span class="err">$group:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">_id:</span><span class="w"> </span><span class="s2">"$productId"</span><span class="p">,</span><span class="w"> </span><span class="err">totalSales:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">$sum:</span><span class="w"> </span><span class="s2">"$amount"</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="err">)</span><span class="w">
</span></code></pre></div> </div> <p>This query groups sales records by <code class="language-plaintext highlighter-rouge">productId</code> and calculates the total sales for each product.</p> </li> <li><strong>Find Top 5 Products by Sales:</strong> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">db.sales.aggregate(</span><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w"> </span><span class="err">$group:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">_id:</span><span class="w"> </span><span class="s2">"$productId"</span><span class="p">,</span><span class="w"> </span><span class="err">totalSales:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">$sum:</span><span class="w"> </span><span class="s2">"$amount"</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w"> </span><span class="err">$sort:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">totalSales:</span><span class="w"> </span><span class="mi">-1</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w"> </span><span class="err">$limit:</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="err">)</span><span class="w">
</span></code></pre></div> </div> <p>This pipeline groups sales by product, sorts them in descending order by total sales, and returns the top 5 products.</p> </li> </ul> </li> </ol> <p>Save the new collections</p> <ul> <li><strong>$merge:</strong> Allows the output of an aggregation pipeline to be written to a collection, either by replacing existing documents or merging the results.</li> <li><strong>$out:</strong> Directly writes the results of an aggregation pipeline to a new collection.</li> </ul> <p><img src="/assets/images/Mongodb/aggregateCode.png" alt="" width="1100px" /></p> <p>Aggregation is a a way to create new collections from existing collections of documents or by modifying them. It is very useful for create a sub-set of documents as a new collections for subsequent analysis.</p> <h3 id="comparison-operators">Comparison Operators</h3> <p>In MongoDB, <code class="language-plaintext highlighter-rouge">$gt</code> is a query operator that stands for “greater than.” It is used to compare a field’s value with a specified value and returns documents where the field’s value is greater than the specified value.</p> <h3 id="syntax">Syntax:</h3> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w"> </span><span class="err">field:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">$gt:</span><span class="w"> </span><span class="err">value</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <ul> <li><strong>field:</strong> The field in the document you want to compare.</li> <li><strong>value:</strong> The value that the field’s value must be greater than to match the document.</li> </ul> <h3 id="example">Example:</h3> <p>Suppose you have a collection called <code class="language-plaintext highlighter-rouge">products</code> with documents that look like this:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
   </span><span class="nl">"_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
   </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Laptop"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"price"</span><span class="p">:</span><span class="w"> </span><span class="mi">1200</span><span class="w">
</span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w">
   </span><span class="nl">"_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
   </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Phone"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"price"</span><span class="p">:</span><span class="w"> </span><span class="mi">800</span><span class="w">
</span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w">
   </span><span class="nl">"_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
   </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tablet"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"price"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <p>To find all products with a price greater than 800, you would use the <code class="language-plaintext highlighter-rouge">$gt</code> operator like this:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">db.products.find(</span><span class="p">{</span><span class="w"> </span><span class="err">price:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">$gt:</span><span class="w"> </span><span class="mi">800</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="err">)</span><span class="w">
</span></code></pre></div></div> <p>This query would return:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
   </span><span class="nl">"_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
   </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Laptop"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"price"</span><span class="p">:</span><span class="w"> </span><span class="mi">1200</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <p>In this example, only the document with the <code class="language-plaintext highlighter-rouge">price</code> of 1200 is returned because it is the only document where the <code class="language-plaintext highlighter-rouge">price</code> is greater than 800.</p> <p>In MongoDB, <code class="language-plaintext highlighter-rouge">$lt</code> is a query operator that stands for “less than.” It is used to compare a field’s value with a specified value and returns documents where the field’s value is less than the specified value.</p> <h3 id="syntax-1">Syntax:</h3> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w"> </span><span class="err">field:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">$lt:</span><span class="w"> </span><span class="err">value</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <ul> <li><strong>field:</strong> The field in the document you want to compare.</li> <li><strong>value:</strong> The value that the field’s value must be less than to match the document.</li> </ul> <h3 id="example-1">Example:</h3> <p>Suppose you have a collection called <code class="language-plaintext highlighter-rouge">products</code> with documents that look like this:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
   </span><span class="nl">"_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
   </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Laptop"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"price"</span><span class="p">:</span><span class="w"> </span><span class="mi">1200</span><span class="w">
</span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w">
   </span><span class="nl">"_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
   </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Phone"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"price"</span><span class="p">:</span><span class="w"> </span><span class="mi">800</span><span class="w">
</span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w">
   </span><span class="nl">"_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
   </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tablet"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"price"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <p>To find all products with a price less than 800, you would use the <code class="language-plaintext highlighter-rouge">$lt</code> operator like this:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">db.products.find(</span><span class="p">{</span><span class="w"> </span><span class="err">price:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">$lt:</span><span class="w"> </span><span class="mi">800</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="err">)</span><span class="w">
</span></code></pre></div></div> <p>This query would return:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
   </span><span class="nl">"_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
   </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tablet"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"price"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <p>In this example, only the document with the <code class="language-plaintext highlighter-rouge">price</code> of 600 is returned because it is the only document where the <code class="language-plaintext highlighter-rouge">price</code> is less than 800.</p> <p>In MongoDB, <code class="language-plaintext highlighter-rouge">$lte</code> is a query operator that stands for “less than or equal to.” It is used to compare a field’s value with a specified value and returns documents where the field’s value is less than or equal to the specified value.</p> <h3 id="syntax-2">Syntax:</h3> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w"> </span><span class="err">field:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">$lte:</span><span class="w"> </span><span class="err">value</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <ul> <li><strong>field:</strong> The field in the document you want to compare.</li> <li><strong>value:</strong> The value that the field’s value must be less than or equal to in order to match the document.</li> </ul> <h3 id="example-2">Example:</h3> <p>Suppose you have a collection called <code class="language-plaintext highlighter-rouge">products</code> with documents like this:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
   </span><span class="nl">"_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
   </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Laptop"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"price"</span><span class="p">:</span><span class="w"> </span><span class="mi">1200</span><span class="w">
</span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w">
   </span><span class="nl">"_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
   </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Phone"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"price"</span><span class="p">:</span><span class="w"> </span><span class="mi">800</span><span class="w">
</span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w">
   </span><span class="nl">"_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
   </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tablet"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"price"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <p>To find all products with a price less than or equal to 800, you would use the <code class="language-plaintext highlighter-rouge">$lte</code> operator like this:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">db.products.find(</span><span class="p">{</span><span class="w"> </span><span class="err">price:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">$lte:</span><span class="w"> </span><span class="mi">800</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="err">)</span><span class="w">
</span></code></pre></div></div> <p>This query would return:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
   </span><span class="nl">"_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
   </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Phone"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"price"</span><span class="p">:</span><span class="w"> </span><span class="mi">800</span><span class="w">
</span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w">
   </span><span class="nl">"_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
   </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tablet"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"price"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <p>In this example, the documents with the <code class="language-plaintext highlighter-rouge">price</code> of 800 and 600 are returned because both prices are less than or equal to 800.</p> <p>In MongoDB, <code class="language-plaintext highlighter-rouge">$gte</code> is a query operator that stands for “greater than or equal to.” It is used to compare a field’s value with a specified value and returns documents where the field’s value is greater than or equal to the specified value.</p> <h3 id="syntax-3">Syntax:</h3> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w"> </span><span class="err">field:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">$gte:</span><span class="w"> </span><span class="err">value</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <ul> <li><strong>field:</strong> The field in the document you want to compare.</li> <li><strong>value:</strong> The value that the field’s value must be greater than or equal to in order to match the document.</li> </ul> <h3 id="example-3">Example:</h3> <p>Suppose you have a collection called <code class="language-plaintext highlighter-rouge">products</code> with documents like this:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
   </span><span class="nl">"_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
   </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Laptop"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"price"</span><span class="p">:</span><span class="w"> </span><span class="mi">1200</span><span class="w">
</span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w">
   </span><span class="nl">"_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
   </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Phone"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"price"</span><span class="p">:</span><span class="w"> </span><span class="mi">800</span><span class="w">
</span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w">
   </span><span class="nl">"_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
   </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Tablet"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"price"</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <p>To find all products with a price greater than or equal to 800, you would use the <code class="language-plaintext highlighter-rouge">$gte</code> operator like this:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">db.products.find(</span><span class="p">{</span><span class="w"> </span><span class="err">price:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">$gte:</span><span class="w"> </span><span class="mi">800</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="err">)</span><span class="w">
</span></code></pre></div></div> <p>This query would return:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
   </span><span class="nl">"_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
   </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Laptop"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"price"</span><span class="p">:</span><span class="w"> </span><span class="mi">1200</span><span class="w">
</span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w">
   </span><span class="nl">"_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
   </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Phone"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"price"</span><span class="p">:</span><span class="w"> </span><span class="mi">800</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <p>In this example, the documents with the <code class="language-plaintext highlighter-rouge">price</code> of 1200 and 800 are returned because both prices are greater than or equal to 800.</p> <p>In MongoDB, the <code class="language-plaintext highlighter-rouge">$in</code> operator is used to match documents where the value of a field equals any value in a specified array. It is equivalent to the SQL <code class="language-plaintext highlighter-rouge">IN</code> operator.</p> <h3 id="syntax-4">Syntax:</h3> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w"> </span><span class="err">field:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">$in:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="err">value</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">value</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="err">...</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <ul> <li><strong>field:</strong> The field in the document that you want to check.</li> <li><strong>value1, value2, …:</strong> The values that you want to match against the field. If the field’s value matches any of these values, the document will be included in the results.</li> </ul> <h3 id="example-4">Example:</h3> <p>Suppose you have a collection called <code class="language-plaintext highlighter-rouge">products</code> with documents like this:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
   </span><span class="nl">"_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
   </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Laptop"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"category"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Electronics"</span><span class="w">
</span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w">
   </span><span class="nl">"_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
   </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Desk"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"category"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Furniture"</span><span class="w">
</span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w">
   </span><span class="nl">"_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
   </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Phone"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"category"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Electronics"</span><span class="w">
</span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w">
   </span><span class="nl">"_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
   </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Chair"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"category"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Furniture"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <p>If you want to find all products that belong to either the “Electronics” or “Furniture” category, you would use the <code class="language-plaintext highlighter-rouge">$in</code> operator like this:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">db.products.find(</span><span class="p">{</span><span class="w"> </span><span class="err">category:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">$in:</span><span class="w"> </span><span class="p">[</span><span class="s2">"Electronics"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Furniture"</span><span class="p">]</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="err">)</span><span class="w">
</span></code></pre></div></div> <p>This query would return all documents where the <code class="language-plaintext highlighter-rouge">category</code> field is either “Electronics” or “Furniture”:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
   </span><span class="nl">"_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
   </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Laptop"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"category"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Electronics"</span><span class="w">
</span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w">
   </span><span class="nl">"_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
   </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Desk"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"category"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Furniture"</span><span class="w">
</span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w">
   </span><span class="nl">"_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
   </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Phone"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"category"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Electronics"</span><span class="w">
</span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w">
   </span><span class="nl">"_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
   </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Chair"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"category"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Furniture"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <h3 id="use-cases">Use Cases:</h3> <ul> <li><strong>Filtering by Multiple Values:</strong> <code class="language-plaintext highlighter-rouge">$in</code> is useful when you want to filter documents that can match any value within a specified list. For example, finding all users with specific roles or all orders with certain statuses.</li> <li><strong>Checking Membership in an Array:</strong> If a field contains an array, <code class="language-plaintext highlighter-rouge">$in</code> can be used to check if any element of the array matches one of the specified values.</li> </ul> <h3 id="key-points">Key Points:</h3> <ul> <li>If the field contains an array, <code class="language-plaintext highlighter-rouge">$in</code> checks if any of the elements in the array match any of the values in the specified array.</li> <li><code class="language-plaintext highlighter-rouge">$in</code> can be used with both scalar values (e.g., strings, numbers) and arrays within documents.</li> </ul> <p>The <code class="language-plaintext highlighter-rouge">$in</code> operator is a powerful tool for querying documents with multiple potential matching criteria, making it easier to handle complex filtering conditions in MongoDB queries.</p> </div> <div id="disqus_thread"></div> </article> <article class="card" itemscope itemtype="http://schema.org/BlogPosting"> <div class="card-body" itemprop="articleBody"> <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"> <div class="card-header"> <span class="title"> <i class="fa fa-share"></i> Share this to: </span> </div> <div id="share-bar"> <div class="share-buttons"> <a href="https://www.facebook.com/sharer/sharer.php?u=/others/2024/09/26/mongoDB_background/" onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook" > <i class="fa fa-facebook-official share-button"> facebook</i> </a> <a href="https://twitter.com/intent/tweet?text=MongoDB Background&url=/others/2024/09/26/mongoDB_background/" onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter" > <i class="fa fa-twitter share-button"> twitter</i> </a> <a href="https://plus.google.com/share?url=/others/2024/09/26/mongoDB_background/" onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Google+" > <i class="fa fa-google-plus share-button"> google</i> </a> <a href="https://www.pinterest.com/pin/create/button/?url=/others/2024/09/26/mongoDB_background/" onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;" title="Share on Pinterest" > <i class="fa fa-pinterest-p share-button"> pinterest</i> </a> <a href="https://www.tumblr.com/share/link?url=/others/2024/09/26/mongoDB_background/" onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;" title="Share on Tumblr" > <i class="fa fa-tumblr share-button"> tumblr</i> </a> <a href="http://www.reddit.com/submit?url=/others/2024/09/26/mongoDB_background/" onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;" title="Share on Reddit" > <i class="fa fa-reddit-alien share-button"> reddit</i> </a> <a href="https://www.linkedin.com/shareArticle?mini=true&url=/others/2024/09/26/mongoDB_background/&title=MongoDB Background&summary=&source=Wilson Fok" onclick="window.open(this.href, 'pop-up', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn" > <i class="fa fa-linkedin share-button"> linkedin</i> </a> <a href="mailto:?subject=MongoDB Background&amp;body=Check out this site /others/2024/09/26/mongoDB_background/" title="Share via Email" > <i class="fa fa-envelope share-button"> email</i> </a> </div> </div> </div> </article> <script> var disqus_config = function () { this.page.url = "/others/2024/09/26/mongoDB_background/"; /* Replace PAGE_URL with your page's canonical URL variable */ this.page.identifier = "/others/2024/09/26/mongoDB_background"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */ }; (function () { /* DON'T EDIT BELOW THIS LINE */ var d = document, s = d.createElement('script'); s.src = 'https://.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a> </noscript></div> </div> <!-- End of row--> <div class="row"> <div class="col-md-4"> <div class="card"> <div class="card-header"> About </div> <div class="card-body"> <!-- Your Bio --> <p class="author_bio"> Hello, My name is Wilson Fok. I love to extract useful insights and knowledge from big data. Constructive feedback and insightful comments are very welcome!</p> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Categories </div> <div class="card-body text-dark"> <div id="#Finance"></div> <li class="tag-head"> <a href="/blog/categories/Finance">Finance</a> </li> <a name="Finance"></a> <div id="#NLP"></div> <li class="tag-head"> <a href="/blog/categories/NLP">NLP</a> </li> <a name="NLP"></a> <div id="#Deep_Learning"></div> <li class="tag-head"> <a href="/blog/categories/Deep_Learning">Deep_Learning</a> </li> <a name="Deep_Learning"></a> <div id="#Others"></div> <li class="tag-head"> <a href="/blog/categories/Others">Others</a> </li> <a name="Others"></a> <div id="#Reading"></div> <li class="tag-head"> <a href="/blog/categories/Reading">Reading</a> </li> <a name="Reading"></a> <div id="#Toastmasters"></div> <li class="tag-head"> <a href="/blog/categories/Toastmasters">Toastmasters</a> </li> <a name="Toastmasters"></a> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Useful Links </div> <div class="card-body text-dark"> <li > <a href="/about">About Me</a> </li> <li > <a href="/blog">Blog</a> </li> <li > <a href="/blog/categories">Categories</a> </li> <li > <a href="/gallery">Gallery</a> </li> <li > <a href="/contact">Contact Me</a> </li> </div> </div> </div> </div> </div> <footer> <p> Powered by Jekyll. Hosted on <a href="https://pages.github.com">Github</a>. Subscribe via <a href=" /feed.xml ">RSS <i class="fa fa-rss" aria-hidden="true"></i> </a> </p> </footer> </div> <script> var options = { classname: 'my-class', id: 'my-id' }; var nanobar = new Nanobar( options ); nanobar.go( 30 ); nanobar.go( 76 ); nanobar.go(100); </script> <!-- <div hidden id="snipcart" data-api-key="Y2I1NTAyNWYtMTNkMy00ODg0LWE4NDItNTZhYzUxNzJkZTI5NjM3MDI4NTUzNzYyMjQ4NzU0"></div> <script src="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.js" defer></script> --> <script src="/assets/js/mode-switcher.js"></script> <script src="/assets/js/slideshow.js"></script> </body> </html>
