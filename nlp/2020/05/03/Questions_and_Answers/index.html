<!DOCTYPE html> <html lang=" en "><head> <meta charset="utf-8"> <title>Wilson Fok - A data science enthusiast</title> <meta http-equip="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <meta name="description" content="Questions and Answers" /> <meta name="keywords" content="Questions and Answers, Wilson Fok, NLP" /> <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml"> <meta content="" property="fb:app_id"> <meta content="Wilson Fok" property="og:site_name"> <meta content="Questions and Answers" property="og:title"> <meta content="article" property="og:type"> <meta content="Using Python, Gensim,and NLTK to find articles on COVID-19" property="og:description"> <meta content="/nlp/2020/05/03/Questions_and_Answers/" property="og:url"> <meta content="2020-05-03T00:00:00+08:00" property="article:published_time"> <meta content="/about/" property="article:author"> <meta content="NLP" property="article:section"> <meta name="twitter:card" content="summary"> <meta name="twitter:site" content="@"> <meta name="twitter:creator" content="@"> <meta name="twitter:title" content="Questions and Answers"> <meta content="Wilson Fok" property="og:site_name"> <meta name="twitter:url" content="/nlp/2020/05/03/Questions_and_Answers/"> <meta name="twitter:description" content="Hello, My name is Wilson Fok. I love to extract useful insights and knowledge from big data. I also like to make new friends and connections. Let's connect! "> <!-- load layout style css --> <link rel="stylesheet" href="/assets/css/main.css" /> <link rel="stylesheet" href="/assets/css/custom-style.css" /> <link rel="stylesheet" href="/assets/bower_components/lightgallery/dist/css/lightgallery.min.css"/> <link rel="stylesheet" href="/assets/bower_components/bootstrap/dist/css/bootstrap.min.css" /> <link rel="stylesheet" href="/assets/bower_components/font-awesome/web-fonts-with-css/css/fontawesome-all.min.css" /> <!-- Favicon --> <link rel="icon" href="/assets/img/favicon.ico" type="image/gif" sizes="16x16"> <!-- Jquery --> <!-- one or more of the below scripts does fancy word animation and dropdown menu --> <script src="/assets/extra_js/jquery-3.4.1.min.js"></script> <script src="/assets/extra_js/picturefill min/picturefill.min.js"></script> <script src="/assets/extra_js/instantsearch min/instantsearch.min.js"></script> <script src="/assets/extra_js/moment min/moment.min.js"></script> <script src="/assets/bower_components/jquery.easing/jquery.easing.min.js"></script> <script src="/assets/bower_components/bootstrap/dist/js/bootstrap.bundle.min.js"></script> <script src="/assets/bower_components/jquery-mousewheel/jquery.mousewheel.min.js"></script> <script src="/assets/bower_components/lightgallery/dist/js/lightgallery-all.min.js"></script> <script src="/assets/bower_components/imagesloaded/imagesloaded.pkgd.min.js"></script> <script src="/assets/bower_components/nanobar/nanobar.min.js"></script> <script src="/assets/bower_components/typewrite/dist/typewrite.min.js"></script> </head><body> <div class="container-fluid"><header> <div class="col-lg-12"> <div class="row"> <nav class="navbar navbar-expand-lg fixed-top navbar-dark " id="topNav"> <!-- <a class="navbar-brand" href="#">Wilson Fok</a> --> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <a class="navbar-brand" href="/">Wilson Fok</a> <div class="collapse navbar-collapse" id="navbarNav"> <ul class="navbar-nav"> <li class="nav-item"> <a class="nav-link" href="/about">About Me</a> </li> <li class="nav-item"> <a class="nav-link" href="/blog">Blog</a> </li> <li class="nav-item"> <a class="nav-link" href="/blog/categories">Categories</a> </li> <li class="nav-item"> <a class="nav-link" href="/contact">Contact Me</a> </li> </ul> </div> <ul class="nav justify-content-end"> <!-- <li class="nav-item"> <a class="nav-link" id="search-icon" href="/search/"><i class="fa fa-search" aria-hidden="true"></i></a> </li> --> <li class="nav-item"> <input class="nav-link switch" id="theme-toggle" onclick="modeSwitcher() "type="checkbox" name="checkbox" > </li> </ul> </nav> </div> </div> </header><div class="col-lg-12"> <!-- Blog Post Breadcrumbs --><div class="col-lg-12"> <nav aria-label="breadcrumb" role="navigation"> <ol class="breadcrumb"> <li class="breadcrumb-item"> <a href="/blog"><i class="fa fa-home" aria-hidden="true"></i></a> </li> <li class="breadcrumb-item active" aria-current="page"><a href="/nlp/2020/05/03/Questions_and_Answers/">Questions and Answers</a></li> </ol> </nav> </div><div class="row" id="blog-post-container"> <div class="col-lg-8 offset-md-2"><article class="card" itemscope itemtype="http://schema.org/BlogPosting"> <div class="card-header"> <!-- <h1 class="post-title" itemprop="name headline">Questions and Answers</h1> --> <h4 class="post-meta">Using Python, Gensim,and NLTK to find articles on COVID-19</h4> <p class="post-summary">Posted by : <img src="/assets/img/WilsonFokbiggestABI.png" class="author-profile-img"> <span itemprop="author" itemscope itemtype="http://schema.org/Person"> <span itemprop="name">Wilson Fok</span> </span> on <time datetime="2020-05-03 00:00:00 +0800" itemprop="datePublished">May 3, 2020</time> </p> <span class="disqus-comment-count" data-disqus-identifier="/nlp/2020/05/03/Questions_and_Answers/"></span> <div class="post-categories"> Category : <a href="/blog/categories/NLP">NLP</a> </div> </div> <div class="card-body" itemprop="articleBody"> <p>This post follows up from my earlier post on <a href="/nlp/2020/05/02/topics_modelling/">topic modelling</a>, analyzing scientific publications to gain knowledge on COVID-19.</p> <p>Here, I want to delve into a bit deeper on how to use only relatively simple and classic natural language processing techniques to help find semantically similar documents on some subtopics of COVID-19.</p> <p>Specifically, let’s try to find documents pertaining to:</p> <blockquote> <p>Effectiveness of personal protective equipment and its usefulness to reduce risk of transmission in health care and community settings</p> </blockquote> <p>This topic is taken out of a list of topics from <a href="https://www.kaggle.com/allen-institute-for-ai/CORD-19-research-challenge/tasks?taskId=568">COVID-19-research-challenge</a>.</p> <h4 id="prepare-document-corpus">Prepare document Corpus</h4> <p>The preprocessing step for the texts is largely the same as before. However, I have added more tokens in the dictionary by using unigram, bigram and trigram together. This combination is helpful for taking phrases such as “crystal structure” into account.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="n">data_raw</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">()</span> <span class="c1"># raw data from Kaggle
</span>    <span class="n">data_list</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span> <span class="nb">open</span><span class="p">(</span> <span class="s">"data_list.p"</span><span class="p">,</span> <span class="s">"rb"</span> <span class="p">)</span> <span class="p">)</span> <span class="c1"># with preprocessing done already
</span>	

    <span class="c1"># Build the bigram models
</span>    <span class="n">bigram</span> <span class="o">=</span> <span class="n">gensim</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">phrases</span><span class="o">.</span><span class="n">Phrases</span><span class="p">(</span><span class="n">data_list</span><span class="p">[</span><span class="s">'title'</span><span class="p">],</span> <span class="n">min_count</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1"># Build the trigram models
</span>    <span class="n">trigram</span> <span class="o">=</span> <span class="n">gensim</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">phrases</span><span class="o">.</span><span class="n">Phrases</span><span class="p">(</span><span class="n">bigram</span><span class="p">[</span><span class="n">data_list</span><span class="p">[</span><span class="s">'title'</span><span class="p">]],</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    
    <span class="n">breakdown</span> <span class="o">=</span> <span class="n">trigram</span><span class="p">[</span><span class="n">data_list</span><span class="p">[</span><span class="s">'title'</span><span class="p">]]</span>
    
    <span class="c1"># Count n-gram frequencies
</span>    <span class="n">frequency</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">breakdown</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
            <span class="n">frequency</span><span class="p">[</span><span class="n">token</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    
    <span class="n">processed_corpus</span> <span class="o">=</span> <span class="p">[[</span><span class="n">token</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">text</span> <span class="k">if</span> <span class="n">frequency</span><span class="p">[</span><span class="n">token</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">60</span><span class="p">]</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">data_list</span><span class="p">[</span><span class="s">'abstract'</span><span class="p">]]</span>
</code></pre></div></div> <p>Some token examples:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">unigram_examples</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">11</span><span class="p">]:</span> 
<span class="p">[</span><span class="s">'sequence'</span><span class="p">,</span>
 <span class="s">'rna'</span><span class="p">,</span>
 <span class="s">'transfer'</span><span class="p">,</span>
 <span class="s">'synthesis'</span><span class="p">,</span>
 <span class="s">'murine'</span><span class="p">,</span>
 <span class="s">'coronavirus'</span><span class="p">,</span>
 <span class="s">'receptor'</span><span class="p">,</span>
 <span class="s">'family'</span><span class="p">,</span>
 <span class="s">'novel'</span><span class="p">,</span>
 <span class="s">'protein'</span><span class="p">]</span>
 
 <span class="n">bigram_examples</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">12</span><span class="p">]:</span> 
<span class="p">[</span><span class="s">'crystal_structure'</span><span class="p">,</span>
 <span class="s">'hepatitis_virus'</span><span class="p">,</span>
 <span class="s">'rt_pcr'</span><span class="p">,</span>
 <span class="s">'severe_acute'</span><span class="p">,</span>
 <span class="s">'respiratory_syndrome'</span><span class="p">,</span>
 <span class="s">'sars_cov'</span><span class="p">,</span>
 <span class="s">'rna_synthesis'</span><span class="p">,</span>
 <span class="s">'vaccinia_virus'</span><span class="p">,</span>
 <span class="s">'sars_coronavirus'</span><span class="p">,</span>
 <span class="s">'intensive_care'</span><span class="p">]</span>
 
 <span class="n">trigram_examples</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">16</span><span class="p">]:</span> 
<span class="p">[</span><span class="s">'ucc_uuu_cgu'</span><span class="p">,</span>
 <span class="s">'002_05_2015'</span><span class="p">,</span>
 <span class="s">'x_xxy_yyz'</span><span class="p">,</span>
 <span class="s">'x_xxz_zzn'</span><span class="p">,</span>
 <span class="s">'run_tiled_primers'</span><span class="p">,</span>
 <span class="s">'g_guu_uuu'</span><span class="p">,</span>
 <span class="s">'dme1_chrx_2630566'</span><span class="p">,</span>
 <span class="s">'ssc_circ_009380'</span><span class="p">,</span>
 <span class="s">'vb_bbrs_phb09'</span><span class="p">,</span>
 <span class="s">'vb_bbrm_phb04'</span><span class="p">]</span>
</code></pre></div></div> <h4 id="query">Query</h4> <p>I create a dictionary, convert the documents to a bag-of-word vectors, construct a term-frequency-inverse-document-frequency matrix, and calculate the similarity of the corpus based on cosine distance.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1">############ Gensim
</span>
    <span class="n">dictionary</span> <span class="o">=</span> <span class="n">corpora</span><span class="o">.</span><span class="n">Dictionary</span><span class="p">(</span><span class="n">processed_corpus</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">dictionary</span><span class="p">)</span>
    
    
    <span class="n">bow_corpus</span> <span class="o">=</span> <span class="p">[</span><span class="n">dictionary</span><span class="o">.</span><span class="n">doc2bow</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">processed_corpus</span><span class="p">]</span>
    <span class="c1"># train the model
</span>    <span class="n">tfidf</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TfidfModel</span><span class="p">(</span><span class="n">bow_corpus</span><span class="p">)</span>
    <span class="n">corpus_tfidf</span> <span class="o">=</span> <span class="n">tfidf</span><span class="p">[</span><span class="n">bow_corpus</span><span class="p">]</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">similarities</span><span class="o">.</span><span class="n">MatrixSimilarity</span><span class="p">(</span><span class="n">corpus_tfidf</span><span class="p">)</span>
</code></pre></div></div> <p>Once I have the similarity matrix of the entire corpus, I can start to compare the query against each one of them.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">25</span><span class="p">):</span>
    
    
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">token</span><span class="p">,</span> <span class="o">*</span><span class="n">vec</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">' '</span><span class="p">)</span>
        <span class="n">vec</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">vec</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">token</span><span class="p">,</span> <span class="n">vec</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span> <span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span>
    
    
<span class="k">def</span> <span class="nf">flatten_list</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span> <span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">x</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">preprocess_query</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="n">stopwords</span><span class="p">,</span> <span class="n">wnl</span><span class="p">,</span> <span class="n">dictionary</span><span class="p">):</span>
    
    <span class="n">words</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">' '</span><span class="p">)</span>
    <span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="n">token</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">words</span><span class="p">]</span>
    <span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="n">token</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">words</span> <span class="k">if</span> <span class="n">token</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stopwords</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="s">'english'</span><span class="p">)]</span>
       
    <span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="n">wnl</span><span class="o">.</span><span class="n">lemmatize</span><span class="p">(</span><span class="n">token</span><span class="p">)</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">words</span><span class="p">]</span>
    <span class="n">query_vec</span> <span class="o">=</span> <span class="n">dictionary</span><span class="o">.</span><span class="n">doc2bow</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">query_vec</span>


<span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">tfidf</span><span class="p">,</span> <span class="n">word</span><span class="p">,</span> <span class="n">stopwords</span><span class="p">,</span> <span class="n">wnl</span><span class="p">,</span> <span class="n">dictionary</span><span class="p">,</span> <span class="n">data_raw</span><span class="p">,</span> <span class="n">total_doc_samples</span><span class="p">):</span>
    
    <span class="n">query_vec</span> <span class="o">=</span> <span class="n">preprocess_query</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">stopwords</span><span class="p">,</span> <span class="n">wnl</span><span class="p">,</span> <span class="n">dictionary</span><span class="p">)</span>
    
    <span class="n">sims</span> <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="n">tfidf</span><span class="p">[</span><span class="n">query_vec</span><span class="p">]]</span>

    
    <span class="c1"># keep track of how similar each document is to the query
</span>    <span class="n">rank</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span><span class="n">value</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sims</span><span class="p">)}</span>

    <span class="n">sorted_rank</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">rank</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    

    
    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">total_doc_samples</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">string</span> <span class="o">=</span> <span class="n">data_raw</span><span class="p">[</span><span class="s">'title'</span><span class="p">][</span><span class="n">sorted_rank</span><span class="p">[</span><span class="o">-</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">sorted_rank</span><span class="p">[</span><span class="o">-</span><span class="n">i</span><span class="p">],</span> <span class="n">string</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">results</span>
	
</code></pre></div></div> <h4 id="search-results">Search results</h4> <p>I rank all the documents in the order of decreasing similarity and pick only the top 1000 most similar documents.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
    <span class="kn">from</span> <span class="nn">nltk.corpus</span> <span class="kn">import</span> <span class="n">stopwords</span>
    <span class="kn">import</span> <span class="nn">nltk</span>
    <span class="n">wnl</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">WordNetLemmatizer</span><span class="p">()</span>
    
    <span class="n">words</span> <span class="o">=</span> <span class="s">'Effectiveness of personal protective equipment and its usefulness to reduce risk of transmission in health care and community settings'</span>
    
    <span class="n">total_doc_samples</span> <span class="o">=</span> <span class="mi">1000</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">search</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">tfidf</span><span class="p">,</span> <span class="n">words</span><span class="p">,</span> <span class="n">stopwords</span><span class="p">,</span> <span class="n">wnl</span><span class="p">,</span> <span class="n">dictionary</span><span class="p">,</span> <span class="n">data_raw</span><span class="p">,</span> <span class="n">total_doc_samples</span><span class="p">)</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">dictionary</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span>
    <span class="n">sim_x</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">),),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span>
    <span class="n">sim_doc_titles</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">results</span><span class="p">):</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="n">corpus_tfidf</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="n">col</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">]</span>
        <span class="n">v</span> <span class="o">=</span>  <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">]</span>
        <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
        <span class="n">sim_x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">sim_doc_titles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
		
</code></pre></div></div> <p>Since a dry list of documents may be boring to look at, I cluster the search results and put them in a tree. Sklearn provides a very handy script which I adopt for this subtask.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">AgglomerativeClustering</span>
    
    <span class="n">model</span> <span class="o">=</span> <span class="n">AgglomerativeClustering</span><span class="p">(</span><span class="n">affinity</span><span class="o">=</span><span class="s">'cosine'</span><span class="p">,</span>
                                    <span class="n">distance_threshold</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_clusters</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                                    <span class="n">linkage</span><span class="o">=</span><span class="s">'complete'</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    
    <span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">dendrogram</span>
    
    <span class="k">def</span> <span class="nf">plot_dendrogram</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># Create linkage matrix and then plot the dendrogram
</span>    
        <span class="c1"># create the counts of samples under each node
</span>        <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">children_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">n_samples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">merge</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">children_</span><span class="p">):</span>
            <span class="n">current_count</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">child_idx</span> <span class="ow">in</span> <span class="n">merge</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">child_idx</span> <span class="o">&lt;</span> <span class="n">n_samples</span><span class="p">:</span>
                    <span class="n">current_count</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># leaf node
</span>                <span class="k">else</span><span class="p">:</span>
                    <span class="n">current_count</span> <span class="o">+=</span> <span class="n">counts</span><span class="p">[</span><span class="n">child_idx</span> <span class="o">-</span> <span class="n">n_samples</span><span class="p">]</span>
            <span class="n">counts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_count</span>
    
        <span class="n">linkage_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">model</span><span class="o">.</span><span class="n">children_</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">distances_</span><span class="p">,</span>
                                          <span class="n">counts</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    
        <span class="c1"># Plot the corresponding dendrogram
</span>        <span class="n">dendrogram</span><span class="p">(</span><span class="n">linkage_matrix</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


    
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Hierarchical Clustering Dendrogram'</span><span class="p">)</span>
    <span class="c1"># plot the top three levels of the dendrogram
</span>    <span class="n">plot_dendrogram</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">truncate_mode</span><span class="o">=</span><span class="s">'level'</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"Number of points in node (or index of point if no parenthesis)."</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"distances"</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="s">'dendrogram_similar_docs.png'</span><span class="p">),</span> <span class="n">transparent</span><span class="o">=</span><span class="bp">True</span> <span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s">'tight'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div> <p><img src="/assets/images/covid/dendrogram_similar_docs.png" alt="Picture description" width="1400px" /></p> <p><img src="/assets/images/covid/similarity_scores.png" alt="Picture description" width="1400px" /></p> <p>The similarity of documents decays gradually and there aren’t that many semantically similar documents to the query have been found. I group highly similar documents in red, moderately similar documents in blue, and not-quite similar documents in green.</p> <p>I personally would say only those in red are relatively relevant and are therefore worth reading the full content of the articles. Here are the list of some of the titles in each color group.</p> <ul> <li><span style="color:red"> Effectiveness of handwashing in preventing SARS: a review </span></li> <li><span style="color:red"> Response and role of palliative care during the COVID-19 pandemic: a national telephone survey of hospices in Italy </span></li> <li><span style="color:red"> Disinfection efficiency of positive pressure respiratory protective hood using fumigation sterilization cabinet </span></li> <li><span style="color:red"> Rapid De-Escalation and Triaging Patients in Community-Based Palliative Care </span></li> <li><span style="color:red"> Face shields for infection control: A review </span></li> <li><span style="color:red"> Helmet Modification to PPE with 3D Printing During the COVID-19 Pandemic at Duke University Medical Center: A Novel Technique </span></li> <li><span style="color:red"> Personal Protective Equipment </span></li> <li><span style="color:red"> Brief guideline for the prevention of COVID-19 infection in head and neck and otolaryngology surgeons </span></li> <li><span style="color:red"> Taking the right measures to control COVID-19 </span></li> <li><span style="color:red"> Outbreaks in Health Care Settings </span></li> <li><span style="color:red"> The Role of Managerial Epidemiology in Infection Prevention and Control </span></li> <li><span style="color:red"> Elective surgery in the time of COVID-19 </span></li> <li><span style="color:red"> Evaluation of the Person Under Investigation </span></li> <li><span style="color:red"> Appraisal of recommended respiratory infection control practices in primary care and emergency department settings </span></li> <li><span style="color:red"> Methicillin-resistant Staphylococcus aureus, Clostridium difficile, and extended-spectrum β-lactamase–producing Escherichia coli in the community: Assessing the problem and controlling the spread </span></li> <li><span style="color:red"> Variation in health care worker removal of personal protective equipment </span></li> <li><span style="color:red"> How Should U.S. Hospitals Prepare for Coronavirus Disease 2019 (COVID-19)? </span></li> <li><span style="color:red"> Head and neck oncology during the COVID-19 pandemic: Reconsidering traditional treatment paradigms in light of new surgical and other multilevel risks </span></li> <li><span style="color:red"> Modeling layered non-pharmaceutical interventions against SARS-CoV-2 in the United States with Corvid </span></li> <li><span style="color:red"> Protecting health care workers from SARS and other respiratory pathogens: A review of the infection control literature </span></li> </ul> <ul> <li><span style="color:blue"> Covid-19: What’s the current advice for UK doctors? </span></li> <li><span style="color:blue"> Cost-effectiveness analysis of N95 respirators and medical masks to protect healthcare workers in China from respiratory infections </span></li> <li><span style="color:blue"> Assessment of Temporary Community-Based Health Care Facilities During Arbaeenia Mass Gathering at Karbala, Iraq: Cross-Sectional Survey Study </span></li> <li><span style="color:blue"> 23 Response to SARS as a prototype for bioterrorism Lessons in a Regional Hospital in Hong Kong </span></li> <li><span style="color:blue"> Recommendations and guidance for providing pharmaceutical care services during COVID-19 pandemic: A China perspective </span></li> <li><span style="color:blue"> Could influenza transmission be reduced by restricting mass gatherings? Towards an evidence-based policy framework </span></li> <li><span style="color:blue"> Equipment for Exotic Mammal and Reptile Diagnostics and Surgery </span></li> <li><span style="color:blue"> Infrastructure and Organization of Adult Intensive Care Units in Resource-Limited Settings </span></li> <li><span style="color:blue"> Risk factors for febrile respiratory illness and mono-viral infections in a semi-closed military environment: a case-control study </span></li> <li><span style="color:blue"> Contamination during doffing of personal protective equipment by healthcare providers </span></li> <li><span style="color:blue"> Facing the threat of influenza pandemic - roles of and implications to general practitioners </span></li> <li><span style="color:blue"> Supplies and equipment for pediatric emergency mass critical care </span></li> <li><span style="color:blue"> SARS Transmission among Hospital Workers in Hong Kong </span></li> <li><span style="color:blue"> The Demand for Health Care </span></li> <li><span style="color:blue"> Isolation Facilities for Highly Infectious Diseases in Europe – A Cross-Sectional Analysis in 16 Countries </span></li> <li><span style="color:blue"> A systematic risk-based strategy to select personal protective equipment for infectious diseases </span></li> <li><span style="color:blue"> 4 Steps in the selection of protective clothing materials </span></li> <li><span style="color:blue"> Helen Salisbury: Is general practice prepared for a pandemic? </span></li> <li><span style="color:blue"> Performance of materials used for biological personal protective equipment against blood splash penetration </span></li> <li><span style="color:blue"> Role of viral bioaerosols in nosocomial infections and measures for prevention and control </span></li> </ul> <ul> <li><span style="color:green"> Guideline for Antibiotic Use in Adults with Community-acquired Pneumonia </span></li> <li><span style="color:green"> Hydroxychloroquine (HCQ): an observational cohort study in primary and secondary prevention of pneumonia in an at-risk population </span></li> <li><span style="color:green"> On the 2-Row Rule for Infectious Disease Transmission on Aircraft </span></li> <li><span style="color:green"> The outbreak of COVID-19: An overview </span></li> <li><span style="color:green"> Hendra virus in Queensland, Australia, during the winter of 2011: Veterinarians on the path to better management strategies </span></li> <li><span style="color:green"> Visibility and transmission: complexities around promoting hand hygiene in young children – a qualitative study </span></li> <li><span style="color:green"> Mapping road network communities for guiding disease surveillance and control strategies </span></li> <li><span style="color:green"> A COVID-19 Risk Assessment for the US Labor Force </span></li> <li><span style="color:green"> Gut microbiome and the risk factors in central nervous system autoimmunity </span></li> <li><span style="color:green"> Public health and medical care for the world's factory: China's Pearl River Delta Region </span></li> <li><span style="color:green"> Global health goals: lessons from the worldwide effort to eradicate poliomyelitis </span></li> <li><span style="color:green"> Population response to the risk of vector-borne diseases: lessons learned from socio-behavioural research during large-scale outbreaks </span></li> <li><span style="color:green"> Reduced Risk of Importing Ebola Virus Disease because of Travel Restrictions in 2014: A Retrospective Epidemiological Modeling Study </span></li> <li><span style="color:green"> Investigation of three clusters of COVID-19 in Singapore: implications for surveillance and response measures </span></li> <li><span style="color:green"> The Perceived Threat of SARS and its Impact on Precautionary Actions and Adverse Consequences: A Qualitative Study Among Chinese Communities in the United Kingdom and the Netherlands </span></li> <li><span style="color:green"> Association of COVID-19 Infections in San Francisco in Early March 2020 with Travel to New York and Europe </span></li> <li><span style="color:green"> Harnessing the privatisation of China's fragmented health-care delivery </span></li> <li><span style="color:green"> Toward a consensus view in the management of acute facial injuries during the Covid-19 pandemic </span></li> <li><span style="color:green"> Selected nonvaccine interventions to prevent infectious acute respiratory disease </span></li> <li><span style="color:green"> Prevalence of Psychiatric Disorders Among Toronto Hospital Workers One to Two Years After the SARS Outbreak </span></li> </ul> </div> <div id="disqus_thread"></div> </article> <script> var disqus_config = function () { this.page.url = "/nlp/2020/05/03/Questions_and_Answers/"; /* Replace PAGE_URL with your page's canonical URL variable */ this.page.identifier = "/nlp/2020/05/03/Questions_and_Answers"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */ }; (function () { /* DON'T EDIT BELOW THIS LINE */ var d = document, s = d.createElement('script'); s.src = 'https://.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a> </noscript></div> </div> <!-- End of row--> <div class="row"> <div class="col-md-4"> <div class="card"> <div class="card-header"> About </div> <div class="card-body"> <!-- Your Bio --> <p class="author_bio"> Hello, My name is Wilson Fok. I love to extract useful insights and knowledge from big data. Constructive feedback and insightful comments are very welcome!</p> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Categories </div> <div class="card-body text-dark"> <div id="#finance"></div> <li class="tag-head"> <a href="/blog/categories/finance">finance</a> </li> <a name="finance"></a> <div id="#NLP"></div> <li class="tag-head"> <a href="/blog/categories/NLP">NLP</a> </li> <a name="NLP"></a> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Useful Links </div> <div class="card-body text-dark"> <li > <a href="/about">About Me</a> </li> <li > <a href="/blog">Blog</a> </li> <li > <a href="/blog/categories">Categories</a> </li> <li > <a href="/contact">Contact Me</a> </li> </div> </div> </div> </div> </div> <footer> <p> Powered by Jekyll. Hosted on <a href="https://pages.github.com">Github</a>. Subscribe via <a href=" /feed.xml ">RSS <i class="fa fa-rss" aria-hidden="true"></i> </a> </p> </footer> </div> <script> var options = { classname: 'my-class', id: 'my-id' }; var nanobar = new Nanobar( options ); nanobar.go( 30 ); nanobar.go( 76 ); nanobar.go(100); </script> <!-- <div hidden id="snipcart" data-api-key="Y2I1NTAyNWYtMTNkMy00ODg0LWE4NDItNTZhYzUxNzJkZTI5NjM3MDI4NTUzNzYyMjQ4NzU0"></div> <script src="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.js" defer></script> --> <script src="/assets/js/mode-switcher.js"></script> </body> </html>
